(self.webpackChunkBIATemplate=self.webpackChunkBIATemplate||[]).push([[434],{2762:(O,f,t)=>{"use strict";t.d(f,{b:()=>r});const r=(0,t(5094).PH)("[Bia] Success the refresh of the list will be done by signalR.")},8394:(O,f,t)=>{"use strict";t.d(f,{y:()=>r});var r,d,e=t(5094);(d=r||(r={})).loadAll=(0,e.PH)("[Domain LDAP Domains] Load all"),d.loadAllSuccess=(0,e.PH)("[Domain LDAP Domains] Load all success",(0,e.Ky)()),d.failure=(0,e.PH)("[Domain LDAP Domains] Failure",(0,e.Ky)())},601:(O,f,t)=>{"use strict";t.d(f,{q2:()=>o,ll:()=>v});var e=t(5685),r=t(5094),d=t(8394);const m=(0,e.H)({selectId:s=>s.ldapName,sortComparer:!1}),E=m.getInitialState({}),h=(0,r.Lq)(E,(0,r.on)(d.y.loadAllSuccess,(s,{ldapDomains:u})=>m.setAll(u,s)));function v(s,u){return(0,r.UY)({ldapDomain:h})(s,u)}const g=(0,r.ZF)("domain-ldap-domains"),_=(0,r.P1)(g,s=>s.ldapDomain),{selectAll:o}=m.getSelectors(_)},2566:(O,f,t)=>{"use strict";t.d(f,{p:()=>y});var e=t(6517),r=t(5094),d=t(5424),m=t(1086),E=t(373),h=t(7545),v=t(4850),g=t(7221),_=t(4016),o=t(5e3);let s=(()=>{class i extends _.Z{constructor(c){super(c,"Roles")}}return i.\u0275fac=function(c){return new(c||i)(o.LFG(o.zs3))},i.\u0275prov=o.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var u=t(6875),n=t(42);let p=(()=>{class i{constructor(c,F,U){this.actions$=c,this.roleDas=F,this.biaMessageService=U,this.loadAll$=(0,e.GW)(()=>this.actions$.pipe((0,e.l4)(u.E.loadAll),(0,E.j)("teamTypeId"),(0,h.w)(M=>this.roleDas.getList({endpoint:"allOptions?teamTypeId="+M}).pipe((0,v.U)(T=>u.E.loadAllSuccess({roles:null==T?void 0:T.sort((I,x)=>I.display.localeCompare(x.display))})),(0,g.K)(T=>(this.biaMessageService.showError(),(0,m.of)(u.E.failure({error:T}))))))))}}return i.\u0275fac=function(c){return new(c||i)(o.LFG(e.eX),o.LFG(s),o.LFG(n.X))},i.\u0275prov=o.Yz7({token:i,factory:i.\u0275fac}),i})(),y=(()=>{class i{}return i.\u0275fac=function(c){return new(c||i)},i.\u0275mod=o.oAB({type:i}),i.\u0275inj=o.cJS({providers:[],imports:[[r.Aw.forFeature("domain-role-options",d.ll),e.sQ.forFeature([p])]]}),i})()},5424:(O,f,t)=>{"use strict";t.d(f,{wA:()=>s,ll:()=>g});var e=t(5685),r=t(5094),d=t(6875);const m=(0,e.H)({selectId:n=>n.id,sortComparer:!1}),E=m.getInitialState({}),h=(0,r.Lq)(E,(0,r.on)(d.E.loadAllSuccess,(n,{roles:p})=>m.setAll(p,n)));function g(n,p){return(0,r.UY)({roleOptions:h})(n,p)}const _=(0,r.ZF)("domain-role-options"),o=(0,r.P1)(_,n=>n.roleOptions),{selectAll:s}=m.getSelectors(o)},6875:(O,f,t)=>{"use strict";t.d(f,{E:()=>r});var r,d,e=t(5094);(d=r||(r={})).loadAll=(0,e.PH)("[Domain Role Options] Load all",(0,e.Ky)()),d.loadAllSuccess=(0,e.PH)("[Domain Role Options] Load all success",(0,e.Ky)()),d.failure=(0,e.PH)("[Domain Role Options] Failure",(0,e.Ky)())},8579:(O,f,t)=>{"use strict";t.d(f,{_:()=>u});var e=t(5e3),r=t(3075),d=t(4626),m=t(277),E=t(9808),h=t(4036),v=t(2145),g=t(845),_=t(7171);const o=function(){return{width:"100%"}};function s(n,p){if(1&n){const y=e.EpF();e.TgZ(0,"div",7)(1,"p-dropdown",14),e.NdJ("onChange",function(D){return e.CHM(y),e.oxw().onDomainChange(D)}),e.qZA(),e.TgZ(2,"label"),e._uU(3,"LDAP Domain"),e.qZA()()}if(2&n){const y=e.oxw();e.xp6(1),e.Akn(e.DdM(3,o)),e.Q6J("options",y.domains)}}let u=(()=>{class n{constructor(y,i){var D,c;this.formBuilder=y,this.searchUsers=new e.vpe,this.save=new e.vpe,this.cancel=new e.vpe,this.returnSizeOptions=[10,25,50,100],this.useKeycloak=!1,this.initForm(),this.useKeycloak=null===(c=null===(D=i.appSettings)||void 0===D?void 0:D.keycloak)||void 0===c?void 0:c.isActive}ngOnChanges(y){this.users&&y.users&&(this.users=this.users.sort((i,D)=>i.displayName.localeCompare(D.displayName)))}initForm(){this.form=this.formBuilder.group({selectedUsers:[this.selectedUsers,r.kI.required],domains:[this.domains],returnSize:this.returnSizeOptions[0]})}onCancel(){this.reset(),this.cancel.next()}onSubmit(){this.form.valid&&(this.save.emit(this.form.value.selectedUsers),this.reset())}reset(){this.selectedDomain="",this.form.reset()}onSearchUsers(y){this.searchUsers.emit({filter:y.query,ldapName:this.selectedDomain,returnSize:this.form.value.returnSize?this.form.value.returnSize:this.returnSizeOptions[0]})}onDomainChange(y){this.selectedDomain=y.value?y.value.ldapName:""}}return n.\u0275fac=function(y){return new(y||n)(e.Y36(r.qu),e.Y36(d.X))},n.\u0275cmp=e.Xpm({type:n,selectors:[["bia-user-from-directory-form"]],inputs:{users:"users",domains:"domains",returnSizeOptions:"returnSizeOptions"},outputs:{searchUsers:"searchUsers",save:"save",cancel:"cancel"},features:[e.TTD],decls:24,vars:29,consts:[["fxLayout","column",3,"formGroup","submit"],["fxLayout","column","fxLayoutAlign","flex-start",1,"p-fluid","app-field-container"],["fxLayout","row","fxLayoutAlign","center"],["fxFlex","50",1,"app-field-container"],["class","p-float-label",4,"ngIf"],["fxFlex","10",1,"app-field-container"],["fxFlex","30",1,"app-field-container"],[1,"p-float-label"],["placeholder","\xa0","formControlName","returnSize","appendTo","body",3,"options"],["fxFlex","90",1,"app-field-container"],["formControlName","selectedUsers","field","displayName","appendTo","body",3,"multiple","suggestions","delay","size","minLength","inputStyle","completeMethod"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","end end"],["pButton","","type","submit",3,"label","disabled"],["pButton","","type","button",1,"p-button-outlined",3,"label","click"],["placeholder","\xa0","formControlName","domains","optionLabel","displayName","showClear","true","appendTo","body",3,"options","onChange"]],template:function(y,i){1&y&&(e.TgZ(0,"form",0),e.NdJ("submit",function(){return i.onSubmit()}),e.TgZ(1,"div",1)(2,"div",2)(3,"div",3),e.YNc(4,s,4,4,"div",4),e.qZA(),e._UZ(5,"div",5),e.TgZ(6,"div",6)(7,"div",7),e._UZ(8,"p-dropdown",8),e.TgZ(9,"label"),e._uU(10),e.ALo(11,"translate"),e.qZA()()()(),e.TgZ(12,"div",2)(13,"div",9)(14,"div",7)(15,"p-autoComplete",10),e.NdJ("completeMethod",function(c){return i.onSearchUsers(c)}),e.qZA(),e.TgZ(16,"label"),e._uU(17),e.ALo(18,"translate"),e.qZA()()()()(),e.TgZ(19,"div",11),e._UZ(20,"button",12),e.ALo(21,"translate"),e.TgZ(22,"button",13),e.NdJ("click",function(){return i.onCancel()}),e.ALo(23,"translate"),e.qZA()()()),2&y&&(e.Q6J("formGroup",i.form),e.xp6(4),e.Q6J("ngIf",!0!==i.useKeycloak),e.xp6(4),e.Akn(e.DdM(26,o)),e.Q6J("options",i.returnSizeOptions),e.xp6(2),e.Oqu(e.lcZ(11,18,"bia.itemsBySearch")),e.xp6(5),e.Akn(e.DdM(27,o)),e.Q6J("multiple",!0)("suggestions",i.users)("delay",700)("size",30)("minLength",3)("inputStyle",e.DdM(28,o)),e.xp6(2),e.Oqu(e.lcZ(18,20,"bia.select")),e.xp6(3),e.s9C("label",e.lcZ(21,22,"bia.save")),e.Q6J("disabled",!i.form.valid),e.xp6(2),e.s9C("label",e.lcZ(23,24,"bia.cancel")))},directives:[r._Y,r.JL,m.xw,r.sg,m.Wh,m.yH,E.O5,h.Lt,r.JJ,r.u,v.Qc,m.SQ,g.Hq],pipes:[_.X$],styles:[".app-field-container[_ngcontent-%COMP%]{margin-bottom:20px}"],changeDetection:0}),n})()},7928:(O,f,t)=>{"use strict";t.d(f,{o1:()=>o,ll:()=>v});var e=t(5685),r=t(5094),d=t(4354);const m=(0,e.H)({selectId:s=>s.domain+"\\"+s.login,sortComparer:!1}),E=m.getInitialState({}),h=(0,r.Lq)(E,(0,r.on)(d.$.loadAllSuccess,(s,{users:u})=>m.setAll(u,s)));function v(s,u){return(0,r.UY)({usersFromDirectory:h})(s,u)}const g=(0,r.ZF)("users-from-directory"),_=(0,r.P1)(g,s=>s.usersFromDirectory),{selectAll:o}=m.getSelectors(_)},4354:(O,f,t)=>{"use strict";t.d(f,{$:()=>r});var r,d,e=t(5094);(d=r||(r={})).loadAllByFilter=(0,e.PH)("[Feature Users From AD] Load all in AD by filter",(0,e.Ky)()),d.loadAllSuccess=(0,e.PH)("[Feature Users From AD] Load all success",(0,e.Ky)()),d.failure=(0,e.PH)("[Feature Users From AD] Failure",(0,e.Ky)()),d.addFromDirectory=(0,e.PH)("[Feature Users From AD] CreateUserFromDirectory",(0,e.Ky)())},3822:(O,f,t)=>{"use strict";t.d(f,{q:()=>Z});var e=t(6517),r=t(5094),d=t(601),m=t(1086),E=t(7545),h=t(4850),v=t(7221),g=t(8394),_=t(4016),o=t(5e3);let s=(()=>{class a{constructor(){}formatDisplayNameFromObs(l){return l.pipe((0,h.U)(A=>this.formatDisplayNames(A)))}formatDisplayNames(l){return l.forEach(A=>{A=this.formatDisplayName(A)}),l}formatDisplayName(l){return l.displayName=`${l.name} (${l.ldapName})`,l}}return a.\u0275fac=function(l){return new(l||a)},a.\u0275prov=o.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})(),u=(()=>{class a extends _.Z{constructor(l,A){super(l,"ldapDomains"),this.ldapDomainService=A}getAll(){return this.ldapDomainService.formatDisplayNameFromObs(this.http.get(this.route))}}return a.\u0275fac=function(l){return new(l||a)(o.LFG(o.zs3),o.LFG(s))},a.\u0275prov=o.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var n=t(42);let p=(()=>{class a{constructor(l,A,P){this.actions$=l,this.ldapDomainDas=A,this.biaMessageService=P,this.loadAll$=(0,e.GW)(()=>this.actions$.pipe((0,e.l4)(g.y.loadAll),(0,E.w)(K=>this.ldapDomainDas.getAll().pipe((0,h.U)(C=>g.y.loadAllSuccess({ldapDomains:C})),(0,v.K)(C=>(this.biaMessageService.showError(),(0,m.of)(g.y.failure({error:C}))))))))}}return a.\u0275fac=function(l){return new(l||a)(o.LFG(e.eX),o.LFG(u),o.LFG(n.X))},a.\u0275prov=o.Yz7({token:a,factory:a.\u0275fac}),a})(),y=(()=>{class a{}return a.\u0275fac=function(l){return new(l||a)},a.\u0275mod=o.oAB({type:a}),a.\u0275inj=o.cJS({imports:[[r.Aw.forFeature("domain-ldap-domains",d.ll),e.sQ.forFeature([p])]]}),a})();var i=t(3931),D=t(9417),F=(t(8579),t(7928)),U=t(373),M=t(4354);let T=(()=>{class a{constructor(){}formatDisplayNameFromADObs(l){return l.pipe((0,h.U)(A=>this.formatDisplayNamesFromAD(A)))}formatDisplayNamesFromAD(l){return l.forEach(A=>{A=this.formatDisplayNameFromAD(A)}),l}formatDisplayNameFromAD(l){return l.displayName=`${l.lastName} ${l.firstName} (${l.domain}\\${l.login})`,l}}return a.\u0275fac=function(l){return new(l||a)},a.\u0275prov=o.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})(),I=(()=>{class a extends _.Z{constructor(l,A){super(l,"users"),this.userService=A}getAllByFilter(l,A,P){return this.userService.formatDisplayNameFromADObs(this.http.get(`${this.route}fromAD?filter=${l}&ldapName=${A}&returnSize=${P}`))}}return a.\u0275fac=function(l){return new(l||a)(o.LFG(o.zs3),o.LFG(T))},a.\u0275prov=o.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var x=t(6048),b=t(7171);let N=(()=>{class a{constructor(l,A,P,K){this.actions$=l,this.userFromDirectoryDas=A,this.biaMessageService=P,this.translateService=K,this.loadAllByFilter$=(0,e.GW)(()=>this.actions$.pipe((0,e.l4)(M.$.loadAllByFilter),(0,E.w)(C=>this.userFromDirectoryDas.getAllByFilter(C.userFilter.filter,C.userFilter.ldapName,C.userFilter.returnSize).pipe((0,h.U)(S=>M.$.loadAllSuccess({users:S})),(0,v.K)(S=>(this.biaMessageService.showError(),(0,m.of)(M.$.failure({error:S})))))))),this.addFromDirectory$=(0,e.GW)(()=>this.actions$.pipe((0,e.l4)(M.$.addFromDirectory),(0,U.j)("usersFromDirectory"),(0,E.w)(C=>this.userFromDirectoryDas.save({items:C,endpoint:"addFromDirectory"}).pipe((0,h.U)(S=>(this.biaMessageService.showAddSuccess(),x.d.userAddedInListSuccess({usersAdded:S}))),(0,v.K)(S=>{if(303===S.status){let R="";S.error&&S.error.forEach($=>{const W=`${this.translateService.instant("user.cannotAddMember")}`.replace("${login}",$);""!==R&&(R+="\n"),R+=W}),this.biaMessageService.showErrorDetail(R)}else this.biaMessageService.showError();return(0,m.of)(M.$.failure({error:{concern:"CREATE",error:S}}))})))))}}return a.\u0275fac=function(l){return new(l||a)(o.LFG(e.eX),o.LFG(I),o.LFG(n.X),o.LFG(b.sK))},a.\u0275prov=o.Yz7({token:a,factory:a.\u0275fac}),a})();t(5224);let Z=(()=>{class a{}return a.\u0275fac=function(l){return new(l||a)},a.\u0275mod=o.oAB({type:a}),a.\u0275inj=o.cJS({imports:[[D.m,r.Aw.forFeature("users-from-directory",F.ll),e.sQ.forFeature([N]),i.U,y]]}),a})()},5224:(O,f,t)=>{"use strict";t.d(f,{C:()=>y});var e=t(655),r=t(5e3),d=t(4354),m=t(7928),E=t(601),h=t(8394),v=t(5094),g=t(5315),_=t(9783),o=t(8579),s=t(7171),u=t(9808);const n=function(){return{minWidth:"50vw"}},p=function(){return{overflow:"auto"}};let y=(()=>{class i{constructor(c){this.store=c,this._display=!1,this.displayChange=new r.vpe}set display(c){this._display=c,this.displayChange.emit(this._display)}ngOnInit(){return(0,e.mG)(this,void 0,void 0,function*(){this.usersFromDirectory$=this.store.select(m.o1),this.ldapDomains$=this.store.select(E.q2),this.store.dispatch(h.y.loadAll())})}onSubmitted(c){this.store.dispatch(d.$.addFromDirectory({usersFromDirectory:c})),this.close()}onCancelled(){this.close()}close(){this.display=!1}onSearchUsers(c){this.store.dispatch(d.$.loadAllByFilter({userFilter:c}))}}return i.\u0275fac=function(c){return new(c||i)(r.Y36(v.yh))},i.\u0275cmp=r.Xpm({type:i,selectors:[["bia-user-add-from-directory-dialog"]],inputs:{display:"display"},outputs:{displayChange:"displayChange"},decls:7,vars:21,consts:[[3,"focusOnShow","visible","modal","closable","responsive","maximizable","draggable","contentStyle","visibleChange"],[3,"users","domains","searchUsers","cancel","save"]],template:function(c,F){1&c&&(r.TgZ(0,"p-dialog",0),r.NdJ("visibleChange",function(M){return F._display=M}),r.TgZ(1,"p-header"),r._uU(2),r.ALo(3,"translate"),r.qZA(),r.TgZ(4,"bia-user-from-directory-form",1),r.NdJ("searchUsers",function(M){return F.onSearchUsers(M)})("cancel",function(){return F.onCancelled()})("save",function(M){return F.onSubmitted(M)}),r.ALo(5,"async"),r.ALo(6,"async"),r.qZA()()),2&c&&(r.Akn(r.DdM(19,n)),r.Q6J("focusOnShow",!1)("visible",F._display)("modal",!0)("closable",!1)("responsive",!0)("maximizable",!0)("draggable",!1)("contentStyle",r.DdM(20,p)),r.xp6(2),r.hij(" ",r.lcZ(3,13,"user.add")," "),r.xp6(2),r.Q6J("users",r.lcZ(5,15,F.usersFromDirectory$))("domains",r.lcZ(6,17,F.ldapDomains$)))},directives:[g.V,_.h4,o._],pipes:[s.X$,u.Ov],styles:[""]}),i})()},4529:(O,f,t)=>{"use strict";t.d(f,{b:()=>e});class e{constructor(d,m){this.key=d,this.value=m}}},9441:function(O,f){var r;void 0!==(r=function(){"use strict";function m(o,s,u){var n=new XMLHttpRequest;n.open("GET",o),n.responseType="blob",n.onload=function(){_(n.response,s,u)},n.onerror=function(){console.error("could not download file")},n.send()}function E(o){var s=new XMLHttpRequest;s.open("HEAD",o,!1);try{s.send()}catch(u){}return 200<=s.status&&299>=s.status}function h(o){try{o.dispatchEvent(new MouseEvent("click"))}catch(u){var s=document.createEvent("MouseEvents");s.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),o.dispatchEvent(s)}}var v="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof global&&global.global===global?global:void 0,g=v.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),_=v.saveAs||("object"!=typeof window||window!==v?function(){}:"download"in HTMLAnchorElement.prototype&&!g?function(o,s,u){var n=v.URL||v.webkitURL,p=document.createElement("a");p.download=s=s||o.name||"download",p.rel="noopener","string"==typeof o?(p.href=o,p.origin===location.origin?h(p):E(p.href)?m(o,s,u):h(p,p.target="_blank")):(p.href=n.createObjectURL(o),setTimeout(function(){n.revokeObjectURL(p.href)},4e4),setTimeout(function(){h(p)},0))}:"msSaveOrOpenBlob"in navigator?function(o,s,u){if(s=s||o.name||"download","string"!=typeof o)navigator.msSaveOrOpenBlob(function d(o,s){return void 0===s?s={autoBom:!1}:"object"!=typeof s&&(console.warn("Deprecated: Expected third argument to be a object"),s={autoBom:!s}),s.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(o.type)?new Blob(["\ufeff",o],{type:o.type}):o}(o,u),s);else if(E(o))m(o,s,u);else{var n=document.createElement("a");n.href=o,n.target="_blank",setTimeout(function(){h(n)})}}:function(o,s,u,n){if((n=n||open("","_blank"))&&(n.document.title=n.document.body.innerText="downloading..."),"string"==typeof o)return m(o,s,u);var p="application/octet-stream"===o.type,y=/constructor/i.test(v.HTMLElement)||v.safari,i=/CriOS\/[\d]+/.test(navigator.userAgent);if((i||p&&y||g)&&"undefined"!=typeof FileReader){var D=new FileReader;D.onloadend=function(){var U=D.result;U=i?U:U.replace(/^data:[^;]*;/,"data:attachment/file;"),n?n.location.href=U:location=U,n=null},D.readAsDataURL(o)}else{var c=v.URL||v.webkitURL,F=c.createObjectURL(o);n?n.location=F:location.href=F,n=null,setTimeout(function(){c.revokeObjectURL(F)},4e4)}});v.saveAs=_.saveAs=_,O.exports=_}.apply(f,[]))&&(O.exports=r)}}]);