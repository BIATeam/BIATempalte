"use strict";(self.webpackChunkBIATemplate=self.webpackChunkBIATemplate||[]).push([[417],{3137:(Ft,Q,i)=>{i.r(Q),i.d(Q,{UserModule:()=>Zt});var b=i(4490),l=i(5094),d=i(6517),h=i(1086),w=i(373),y=i(7545),C=i(4850),T=i(7221),L=i(1406),O=i(7168),F=i(136);const g="feature-users",re=F.k0.Site;var c,n;(n=c||(c={})).loadAllByPost=(0,l.PH)("["+g+"] Load all by post",(0,l.Ky)()),n.load=(0,l.PH)("["+g+"] Load",(0,l.Ky)()),n.create=(0,l.PH)("["+g+"] Create",(0,l.Ky)()),n.update=(0,l.PH)("["+g+"] Update",(0,l.Ky)()),n.remove=(0,l.PH)("["+g+"] Remove",(0,l.Ky)()),n.multiRemove=(0,l.PH)("["+g+"] Multi Remove",(0,l.Ky)()),n.loadAllByPostSuccess=(0,l.PH)("["+g+"] Load all by post success",(0,l.Ky)()),n.loadSuccess=(0,l.PH)("["+g+"] Load success",(0,l.Ky)()),n.failure=(0,l.PH)("["+g+"] Failure",(0,l.Ky)()),n.synchronize=(0,l.PH)("["+g+"] Synchronize");var ce=i(4016),e=i(5e3);let H=(()=>{class n extends ce.Z{constructor(t){super(t,"Users")}synchronize(){return this.http.get(`${this.route}synchronize`)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(e.zs3))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();const M=(0,i(5685).H)({selectId:n=>n.id,sortComparer:!1}),ue=M.getInitialState({totalCount:0,currentUser:{},lastLazyLoadEvent:{},loadingGet:!1,loadingGetAll:!1}),_e=(0,l.Lq)(ue,(0,l.on)(c.loadAllByPost,(n,{})=>Object.assign(Object.assign({},n),{loadingGetAll:!0})),(0,l.on)(c.load,n=>Object.assign(Object.assign({},n),{loadingGet:!0})),(0,l.on)(c.loadAllByPostSuccess,(n,{result:o,event:t})=>{const s=M.setAll(o.data,n);return s.totalCount=o.totalCount,s.lastLazyLoadEvent=t,s.loadingGetAll=!1,s}),(0,l.on)(c.loadSuccess,(n,{user:o})=>Object.assign(Object.assign({},n),{currentUser:o,loadingGet:!1})),(0,l.on)(c.failure,(n,{})=>Object.assign(Object.assign({},n),{loadingGetAll:!1,loadingGet:!1})));function de(n,o){return(0,l.UY)({users:_e})(n,o)}const me=(0,l.ZF)(g),x=(0,l.P1)(me,n=>n.users),he=(0,l.P1)(x,n=>n.totalCount),R=(0,l.P1)(x,n=>n.currentUser),I=(0,l.P1)(x,n=>n.lastLazyLoadEvent),ge=(0,l.P1)(x,n=>n.loadingGet),fe=(0,l.P1)(x,n=>n.loadingGetAll),{selectAll:be}=M.getSelectors(x);i(2762);var K=i(42);let ve=(()=>{class n{constructor(t,s,a,r){this.actions$=t,this.userDas=s,this.biaMessageService=a,this.store=r,this.loadAllByPost$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(c.loadAllByPost),(0,w.j)("event"),(0,y.w)(p=>this.userDas.getListByPost({event:p}).pipe((0,C.U)(u=>c.loadAllByPostSuccess({result:u,event:p})),(0,T.K)(u=>(this.biaMessageService.showError(),(0,h.of)(c.failure({error:u})))))))),this.load$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(c.load),(0,w.j)("id"),(0,y.w)(p=>this.userDas.get({id:p}).pipe((0,C.U)(u=>c.loadSuccess({user:u})),(0,T.K)(u=>(this.biaMessageService.showError(),(0,h.of)(c.failure({error:u})))))))),this.create$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(c.create),(0,w.j)("user"),(0,L.b)(p=>(0,h.of)(p).pipe((0,O.M)(this.store.select(I)))),(0,y.w)(([p,u])=>this.userDas.post({item:p}).pipe((0,C.U)(()=>(this.biaMessageService.showAddSuccess(),c.loadAllByPost({event:u}))),(0,T.K)(f=>(this.biaMessageService.showError(),(0,h.of)(c.failure({error:f})))))))),this.update$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(c.update),(0,w.j)("user"),(0,L.b)(p=>(0,h.of)(p).pipe((0,O.M)(this.store.select(I)))),(0,y.w)(([p,u])=>this.userDas.put({item:p,id:p.id}).pipe((0,C.U)(()=>(this.biaMessageService.showUpdateSuccess(),c.loadAllByPost({event:u}))),(0,T.K)(f=>(this.biaMessageService.showError(),(0,h.of)(c.failure({error:f})))))))),this.synchronize$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(c.synchronize),(0,L.b)(p=>(0,h.of)(p).pipe((0,O.M)(this.store.select(I)))),(0,y.w)(([p,u])=>this.userDas.synchronize().pipe((0,C.U)(()=>(this.biaMessageService.showSyncSuccess(),c.loadAllByPost({event:u}))),(0,T.K)(f=>(this.biaMessageService.showError(),(0,h.of)(c.failure({error:{concern:"CREATE",error:f}})))))))),this.destroy$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(c.remove),(0,w.j)("id"),(0,L.b)(p=>(0,h.of)(p).pipe((0,O.M)(this.store.select(I)))),(0,y.w)(([p,u])=>this.userDas.delete({id:p}).pipe((0,C.U)(()=>(this.biaMessageService.showDeleteSuccess(),c.loadAllByPost({event:u}))),(0,T.K)(f=>(this.biaMessageService.showError(),(0,h.of)(c.failure({error:f})))))))),this.multiDestroy$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(c.multiRemove),(0,w.j)("ids"),(0,L.b)(p=>(0,h.of)(p).pipe((0,O.M)(this.store.select(I)))),(0,y.w)(([p,u])=>this.userDas.deletes({ids:p}).pipe((0,C.U)(()=>(this.biaMessageService.showDeleteSuccess(),c.loadAllByPost({event:u}))),(0,T.K)(f=>(this.biaMessageService.showError(),(0,h.of)(c.failure({error:f}))))))))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(d.eX),e.LFG(H),e.LFG(K.X),e.LFG(l.yh))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();var S=i(2654),B=i(8385),N=i(9157),$=i(1564),Ce=i(9441),P=i(8042),U=i(9206),V=i(7224),ye=i(7145);let Te=(()=>{class n{constructor(t,s,a){this.store=t,this.signalRService=s,this.authService=a}initialize(){console.log("%c [Users] Register SignalR : refresh-users","color: purple; font-weight: bold"),this.signalRService.addMethod("refresh-users",()=>{this.store.select(I).pipe((0,V.P)()).subscribe(t=>{console.log("%c [Users] RefreshSuccess","color: green; font-weight: bold"),this.store.dispatch(c.loadAllByPost({event:t}))})}),this.targetedFeature={parentKey:this.authService.getCurrentTeamId(F.k0.Site).toString(),featureName:"users"},this.signalRService.joinGroup(this.targetedFeature)}destroy(){console.log("%c [Users] Unregister SignalR : refresh-users","color: purple; font-weight: bold"),this.signalRService.removeMethod("refresh-users"),this.signalRService.leaveGroup(this.targetedFeature)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(l.yh),e.LFG(ye.Y),e.LFG($.e))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var xe=i(6468),Se=i(6053),Ue=i(5424),we=i(6875),Ie=i(4529);let Y=(()=>{class n{constructor(t){this.store=t,this.roleOptions$=this.store.select(Ue.wA),this.dictOptionDtos$=(0,Se.aj)([this.roleOptions$]).pipe((0,C.U)(s=>[new Ie.b("roles",s[0])]))}loadAllOptions(){this.store.dispatch(we.E.loadAll({teamTypeId:F.k0.Root}))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(l.yh))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var _=i(3075),j=i(1466),Ae=i(6320),E=i(7171),m=i(9808),v=i(4851),W=i(9783),X=i(1424),Le=i(4784),Oe=i(8786),Ze=i(2081);function Ne(n,o){1&n&&(e.TgZ(0,"th",10),e._UZ(1,"p-tableHeaderCheckbox"),e.qZA())}function Ee(n,o){if(1&n&&(e.TgZ(0,"th",13),e._uU(1),e.ALo(2,"translate"),e._UZ(3,"p-sortIcon",14),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("pSortableColumn",t.field),e.xp6(1),e.hij(" ",e.lcZ(2,3,null==t?null:t.header)," "),e.xp6(2),e.Q6J("field",t.field)}}function Fe(n,o){if(1&n&&(e.TgZ(0,"th",15),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t?null:t.header)," ")}}function De(n,o){if(1&n&&(e.ynx(0),e.YNc(1,Ee,4,5,"th",11),e.YNc(2,Fe,3,3,"th",12),e.BQk()),2&n){const t=o.$implicit;e.xp6(1),e.Q6J("ngIf",!0===(null==t?null:t.isSortable)),e.xp6(1),e.Q6J("ngIf",!0!==(null==t?null:t.isSortable))}}function ze(n,o){1&n&&e._UZ(0,"th")}const Me=function(n){return{"p-state-filled":n}};function Re(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"span",21)(1,"input",22),e.NdJ("input",function(a){e.CHM(t);const r=e.oxw().$implicit;return e.oxw(3),e.MAs(1).filter(a.target.value,r.field,r.filterMode)}),e.ALo(2,"translate"),e.qZA()()}if(2&n){const t=e.oxw().$implicit;e.oxw(3);const s=e.MAs(1);e.xp6(1),e.s9C("type","Number"===t.type?"number":"text"),e.s9C("placeholder",void 0!==t.searchPlaceholder?t.searchPlaceholder:!0===t.isDate?e.lcZ(2,4,"bia.dateIso8601"):""),e.Q6J("value",null==s.filters[t.field]?null:s.filters[t.field].value)("ngClass",e.VKq(6,Me,""!==(null==s.filters[t.field]?null:s.filters[t.field].value)))}}function $e(n,o){if(1&n&&(e.TgZ(0,"th",19),e.YNc(1,Re,3,8,"span",20),e.qZA()),2&n){const t=o.$implicit;e.Q6J("ngSwitch",t.field),e.xp6(1),e.Q6J("ngIf",!0===t.isSearchable)}}function Pe(n,o){if(1&n&&(e.TgZ(0,"tr",16),e.YNc(1,ze,1,0,"th",17),e.YNc(2,$e,2,2,"th",18),e.qZA()),2&n){const t=e.oxw().$implicit,s=e.oxw(2);e.xp6(1),e.Q6J("ngIf",s.canSelectElement),e.xp6(1),e.Q6J("ngForOf",t)}}function Ye(n,o){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,Ne,2,0,"th",7),e.YNc(2,De,3,2,"ng-container",8),e.qZA(),e.YNc(3,Pe,3,2,"tr",9)),2&n){const t=o.$implicit,s=e.oxw(2);e.xp6(1),e.Q6J("ngIf",s.canSelectElement),e.xp6(1),e.Q6J("ngForOf",t),e.xp6(1),e.Q6J("ngIf",s.showColSearch)}}function Je(n,o){if(1&n&&e._UZ(0,"p-tableCheckbox",27),2&n){const t=e.oxw(2).$implicit;e.Q6J("value",t)}}function Qe(n,o){1&n&&e._UZ(0,"i",28)}function Ge(n,o){if(1&n&&(e.TgZ(0,"td"),e.YNc(1,Je,1,1,"p-tableCheckbox",25),e.YNc(2,Qe,1,0,"i",26),e.qZA()),2&n){const t=e.oxw().$implicit,s=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!0!==s.isFooter(t)&&t.id>0),e.xp6(1),e.Q6J("ngIf",!0===s.isFooter(t))}}function He(n,o){1&n&&e.GkF(0)}const Ke=function(n,o){return{field:n,form:o}};function Be(n,o){if(1&n&&e.YNc(0,He,1,0,"ng-container",36),2&n){const t=e.oxw(3).$implicit,s=e.oxw(3);e.Q6J("ngTemplateOutlet",s.specificInputTemplate)("ngTemplateOutletContext",e.WLB(2,Ke,t,s.form))}}function Ve(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"bia-table-input",34),e.NdJ("valueChange",function(){return e.CHM(t),e.oxw(5).onChange()})("complexInput",function(a){return e.CHM(t),e.oxw(5).onComplexInput(a)}),e.YNc(1,Be,1,5,"ng-template",35),e.qZA()}if(2&n){const t=e.oxw(2).$implicit,s=e.oxw(3);e.Q6J("field",t)("form",s.form)("dictOptionDtos",s.dictOptionDtos)}}function je(n,o){1&n&&e.GkF(0)}const k=function(n,o){return{field:n,data:o}};function We(n,o){if(1&n&&e.YNc(0,je,1,0,"ng-container",36),2&n){const t=e.oxw(4).$implicit,s=e.oxw().$implicit,a=e.oxw(2);e.Q6J("ngTemplateOutlet",a.specificOutputTemplate)("ngTemplateOutletContext",e.WLB(2,k,t,a.getCellData(s,t)))}}function Xe(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"bia-table-output",37),e.YNc(2,We,1,5,"ng-template",38),e.qZA(),e.BQk()),2&n){const t=e.oxw(3).$implicit,s=e.oxw().$implicit,a=e.oxw(2);e.xp6(1),e.Q6J("field",t)("data",a.getCellData(s,t))}}function ke(n,o){if(1&n&&e.YNc(0,Xe,3,2,"ng-container",17),2&n){const t=e.oxw(3).$implicit,s=e.oxw(2);e.Q6J("ngIf",!0!==s.isFooter(t))}}function qe(n,o){if(1&n&&(e.YNc(0,Ve,2,3,"ng-template",32),e.YNc(1,ke,1,1,"ng-template",null,33,e.W1O)),2&n){const t=e.MAs(2),s=e.oxw().$implicit;e.Q6J("ngIf",!0===s.isEditable)("ngIfElse",t)}}function et(n,o){1&n&&(e.TgZ(0,"label"),e._uU(1,"-"),e.qZA())}function tt(n,o){if(1&n&&e.YNc(0,et,2,0,"label",17),2&n){const t=e.oxw(2).$implicit;e.Q6J("ngIf",!0===t.isEditable)}}function nt(n,o){1&n&&e.GkF(0)}function st(n,o){if(1&n&&e.YNc(0,nt,1,0,"ng-container",36),2&n){const t=e.oxw(3).$implicit,s=e.oxw().$implicit,a=e.oxw(2);e.Q6J("ngTemplateOutlet",a.specificOutputTemplate)("ngTemplateOutletContext",e.WLB(2,k,t,a.getCellData(s,t)))}}function ot(n,o){if(1&n&&(e.TgZ(0,"bia-table-output",37),e.YNc(1,st,1,5,"ng-template",38),e.qZA()),2&n){const t=e.oxw(2).$implicit,s=e.oxw().$implicit,a=e.oxw(2);e.Q6J("field",t)("data",a.getCellData(s,t))}}function at(n,o){if(1&n&&(e.YNc(0,tt,1,1,"ng-template",32),e.YNc(1,ot,2,2,"ng-template",null,39,e.W1O)),2&n){const t=e.MAs(2),s=e.oxw(2).$implicit,a=e.oxw(2);e.Q6J("ngIf",!0===a.isFooter(s))("ngIfElse",t)}}function it(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"td",29),e.NdJ("click",function(){e.CHM(t);const a=e.oxw().$implicit;return e.oxw(2).initEditableRow(a)}),e.TgZ(1,"p-cellEditor"),e.YNc(2,qe,3,2,"ng-template",30),e.YNc(3,at,3,2,"ng-template",31),e.qZA()()}}function lt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"tr",23),e.NdJ("focusout",function(){return e.CHM(t),e.oxw(2).onFocusout()})("keyup.enter",function(){return e.CHM(t),e.oxw(2).initEditableRow(null)})("keyup.escape",function(){return e.CHM(t),e.oxw(2).cancel()}),e.YNc(1,Ge,3,2,"td",17),e.YNc(2,it,4,0,"td",24),e.qZA()}if(2&n){const t=o.$implicit,s=o.columns,a=e.oxw(2);e.Q6J("pSelectableRow",!0!==a.isFooter(t)?t:null)("pEditableRow",t),e.xp6(1),e.Q6J("ngIf",a.canSelectElement),e.xp6(1),e.Q6J("ngForOf",s)}}function rt(n,o){if(1&n&&(e.TgZ(0,"tr")(1,"td",40),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&n){const t=o.$implicit;e.xp6(1),e.uIk("colspan",t.length+1),e.xp6(1),e.hij(" ",e.lcZ(3,2,"bia.NoRecordsFound")," ")}}function ct(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p-table",2,3),e.NdJ("onFilter",function(){return e.CHM(t),e.oxw().onFilter()})("onLazyLoad",function(a){return e.CHM(t),e.oxw().onLoadLazy(a)})("onStateSave",function(a){return e.CHM(t),e.oxw().onStateSave(a)})("selectionChange",function(){return e.CHM(t),e.oxw().onSelectionChange()}),e.ALo(2,"async"),e.YNc(3,Ye,4,3,"ng-template",4),e.YNc(4,lt,3,4,"ng-template",5),e.YNc(5,rt,4,4,"ng-template",6),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("autoLayout",!0)("reorderableColumns",!0)("columns",t.displayedColumns)("value",t.elements)("paginator",t.paginator)("rows",t.pageSize)("totalRecords",t.totalRecord)("lazy",!0)("loading",t.loading&&null!==e.lcZ(2,14,t.showLoading$))("stateStorage","session")("stateKey",t.tableStateKey)("lazyLoadOnInit",t.getLazyLoadOnInit())("sortField",t.sortFieldValue)("sortOrder",t.sortOrderValue)}}let q=(()=>{class n extends Ae.l{constructor(t,s,a,r){super(t,s,a,r),this.formBuilder=t,this.authService=s,this.biaMessageService=a,this.translateService=r}initForm(){this.form=this.formBuilder.group({id:[this.element.id],firstName:[this.element.firstName,_.kI.required],lastName:[this.element.lastName,_.kI.required],login:[this.element.login,_.kI.required],roles:[this.element.roles]})}onSubmit(){var t;if(this.form.valid){const s=this.form.value;s.id=s.id>0?s.id:0,s.roles=j.P.Differential(s.roles,null===(t=this.element)||void 0===t?void 0:t.roles),this.save.emit(s),this.form.reset()}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(_.qu),e.Y36($.e),e.Y36(K.X),e.Y36(E.sK))},n.\u0275cmp=e.Xpm({type:n,selectors:[["bia-user-table"]],features:[e.qOj],decls:2,vars:2,consts:[[1,"bia-calc-form",3,"formGroup"],["editMode","row","dataKey","id","styleClass","p-datatable-striped",3,"autoLayout","reorderableColumns","columns","value","paginator","rows","totalRecords","lazy","loading","stateStorage","stateKey","lazyLoadOnInit","sortField","sortOrder","onFilter","onLazyLoad","onStateSave","selectionChange",4,"ngIf"],["editMode","row","dataKey","id","styleClass","p-datatable-striped",3,"autoLayout","reorderableColumns","columns","value","paginator","rows","totalRecords","lazy","loading","stateStorage","stateKey","lazyLoadOnInit","sortField","sortOrder","onFilter","onLazyLoad","onStateSave","selectionChange"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["class","bia-table-select-col",4,"ngIf"],[4,"ngFor","ngForOf"],["class","searchTR",4,"ngIf"],[1,"bia-table-select-col"],["pReorderableColumn","",3,"pSortableColumn",4,"ngIf"],["pReorderableColumn","",4,"ngIf"],["pReorderableColumn","",3,"pSortableColumn"],[3,"field"],["pReorderableColumn",""],[1,"searchTR"],[4,"ngIf"],["pReorderableColumn","",3,"ngSwitch",4,"ngFor","ngForOf"],["pReorderableColumn","",3,"ngSwitch"],["class","p-float-label",4,"ngIf"],[1,"p-float-label"],["pInputText","",1,"input-search",3,"type","placeholder","value","ngClass","input"],[3,"pSelectableRow","pEditableRow","focusout","keyup.enter","keyup.escape"],[3,"click",4,"ngFor","ngForOf"],[3,"value",4,"ngIf"],["class","pi pi-plus",4,"ngIf"],[3,"value"],[1,"pi","pi-plus"],[3,"click"],["pTemplate","input"],["pTemplate","output"],[3,"ngIf","ngIfElse"],["isNotEditable",""],[3,"field","form","dictOptionDtos","valueChange","complexInput"],["pTemplate","specificInput"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"field","data"],["pTemplate","specificOutput"],["editRow",""],[1,"app-empty-message"]],template:function(t,s){1&t&&(e.TgZ(0,"form",0),e.YNc(1,ct,6,16,"p-table",1),e.qZA()),2&t&&(e.Q6J("formGroup",s.form),e.xp6(1),e.Q6J("ngIf",s.configuration))},directives:[_._Y,_.JL,_.sg,m.O5,v.iA,W.jx,v.Mo,m.sg,v.Af,v.lQ,v.fz,m.RF,X.o,m.mk,Le.oO,v.Ei,v.D$,v.UA,v.YL,Oe.P,m.tP,Ze.T],pipes:[m.Ov,E.X$],styles:["[_nghost-%COMP%]{flex-direction:column}[_nghost-%COMP%]     p-table .searchTR .p-float-label .p-inputtext{padding-top:2px!important}.input-search[_ngcontent-%COMP%]{width:99%}.app-empty-message[_ngcontent-%COMP%]{text-align:center!important}table[_ngcontent-%COMP%]{width:100%}.bia-table-select-col[_ngcontent-%COMP%]{width:60px}"]}),n})();var ee=i(1307),pt=i(5863),A=i(277),ut=i(1606),te=i(845),_t=i(6743),dt=i(5224);function mt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"button",9),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).onSynchronize()}),e.ALo(1,"translate"),e.qZA()}2&n&&e.s9C("label",e.lcZ(1,1,"bia.synchronize"))}function ht(n,o){if(1&n&&e.YNc(0,mt,2,3,"button",8),2&n){const t=e.oxw();e.Q6J("ngIf",t.canSync)}}function gt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"bia-table",10),e.NdJ("clickRow",function(a){return e.CHM(t),e.oxw().onEdit(a)})("loadLazy",function(a){return e.CHM(t),e.oxw().onLoadLazy(a)})("selectedElementsChanged",function(a){return e.CHM(t),e.oxw().onSelectedElementsChanged(a)}),e.ALo(1,"async"),e.ALo(2,"async"),e.ALo(3,"async"),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("elements",e.lcZ(1,12,t.users$))("totalRecord",e.lcZ(2,14,t.totalCount$))("columnToDisplays",t.displayedColumns)("pageSize",t.pageSize)("configuration",t.tableConfiguration)("showColSearch",t.showColSearch)("globalSearchValue",t.globalSearchValue)("canClickRow",t.canEdit)("canSelectElement",t.canDelete)("loading",e.lcZ(3,16,t.loading$))("viewPreference",t.viewPreference)("tableStateKey",t.tableStateKey)}}function ft(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"bia-user-table",11),e.NdJ("loadLazy",function(a){return e.CHM(t),e.oxw().onLoadLazy(a)})("selectedElementsChanged",function(a){return e.CHM(t),e.oxw().onSelectedElementsChanged(a)})("save",function(a){return e.CHM(t),e.oxw().onSave(a)}),e.ALo(1,"async"),e.ALo(2,"async"),e.ALo(3,"async"),e.ALo(4,"async"),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("elements",e.lcZ(1,14,t.users$))("dictOptionDtos",e.lcZ(2,16,t.userOptionsService.dictOptionDtos$))("totalRecord",e.lcZ(3,18,t.totalCount$))("columnToDisplays",t.displayedColumns)("pageSize",t.pageSize)("configuration",t.tableConfiguration)("showColSearch",t.showColSearch)("globalSearchValue",t.globalSearchValue)("canEdit",t.canEdit)("canAdd",t.canAdd)("canSelectElement",t.canDelete)("loading",e.lcZ(4,20,t.loading$))("viewPreference",t.viewPreference)("tableStateKey",t.tableStateKey)}}let bt=(()=>{class n{constructor(t,s,a,r,p,u,f,Nt,Et){this.store=t,this.router=s,this.activatedRoute=a,this.authService=r,this.userDas=p,this.translateService=u,this.biaTranslationService=f,this.usersSignalRService=Nt,this.userOptionsService=Et,this.useCalcMode=!1,this.useSignalR=false,this.useView=!1,this.useRefreshAtLanguageChange=!1,this.flex=!0,this.sub=new S.w,this.showColSearch=!1,this.globalSearchValue="",this.defaultPageSize=F.L8,this.pageSize=this.defaultPageSize,this.canEdit=!1,this.canDelete=!1,this.canAdd=!1,this.canSync=!1,this.tableStateKey=this.useView?"usersGrid":void 0,this.useViewTeamWithTypeId=this.useView?re:null,this.displayUserAddFromDirectoryDialog=!1}get userListComponent(){return void 0!==this.biaTableComponent?this.biaTableComponent:this.userTableComponent}ngOnInit(){this.parentIds=[],this.sub=new S.w,this.initTableConfiguration(),this.setPermissions(),this.users$=this.store.select(be),this.totalCount$=this.store.select(he),this.loading$=this.store.select(fe),this.OnDisplay(),this.useCalcMode&&this.sub.add(this.biaTranslationService.currentCulture$.subscribe(t=>{this.userOptionsService.loadAllOptions()})),this.useRefreshAtLanguageChange&&this.sub.add(this.biaTranslationService.currentCulture$.pipe((0,ee.T)(1)).subscribe(t=>{this.onLoadLazy(this.userListComponent.getLazyLoadMetadata())})),this.sub.add(this.store.select(pt.nC).pipe((0,ee.T)(1)).subscribe(t=>{setTimeout(()=>this.onLoadLazy(this.userListComponent.getLazyLoadMetadata()))}))}ngOnDestroy(){this.sub&&this.sub.unsubscribe(),this.OnHide()}OnDisplay(){this.useView&&this.store.dispatch((0,xe.Tx)()),this.useSignalR&&this.usersSignalRService.initialize()}OnHide(){this.useSignalR&&this.usersSignalRService.destroy()}onCreate(){this.displayUserAddFromDirectoryDialog=!0}onEdit(t){this.useCalcMode||this.router.navigate([t,"edit"],{relativeTo:this.activatedRoute})}onSave(t){this.useCalcMode&&((null==t?void 0:t.id)>0?this.canEdit&&this.store.dispatch(c.update({user:t})):this.canAdd&&this.store.dispatch(c.create({user:t})))}onDelete(){this.selectedUsers&&this.canDelete&&this.store.dispatch(c.multiRemove({ids:this.selectedUsers.map(t=>t.id)}))}onSelectedElementsChanged(t){this.selectedUsers=t}onPageSizeChange(t){this.pageSize=t}onLoadLazy(t){const s=Object.assign({parentIds:this.parentIds},t);this.store.dispatch(c.loadAllByPost({event:s}))}searchGlobalChanged(t){this.globalSearchValue=t}displayedColumnsChanged(t){this.displayedColumns=t}onToggleSearch(){this.showColSearch=!this.showColSearch}onViewChange(t){this.viewPreference=t}onExportCSV(){const t={};this.userListComponent.getPrimeNgTable().columns.map(a=>t[a.field]=this.translateService.instant(a.header));const s=Object.assign({parentIds:this.parentIds,columns:t},this.userListComponent.getLazyLoadMetadata());this.userDas.getFile(s).subscribe(a=>{Ce.saveAs(a,this.translateService.instant("app.users")+".csv")})}onSynchronize(){this.store.dispatch(c.synchronize())}setPermissions(){this.canSync=this.authService.hasPermission(U.y.User_Sync),this.canEdit=this.authService.hasPermission(U.y.User_UpdateRoles),this.canDelete=this.authService.hasPermission(U.y.User_Delete),this.canAdd=this.authService.hasPermission(U.y.User_Add)}initTableConfiguration(){this.sub.add(this.biaTranslationService.currentCultureDateFormat$.subscribe(t=>{this.tableConfiguration={columns:[new N.kc("lastName","user.lastName"),new N.kc("firstName","user.firstName"),new N.kc("login","user.login"),Object.assign(new N.kc("roles","member.roles"),{type:N.d5.ManyToMany})]},this.columns=this.tableConfiguration.columns.map(s=>({key:s.field,value:s.header})),this.displayedColumns=[...this.columns]}))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.yh),e.Y36(b.F0),e.Y36(b.gz),e.Y36($.e),e.Y36(H),e.Y36(E.sK),e.Y36(P.P6),e.Y36(Te),e.Y36(Y))},n.\u0275cmp=e.Xpm({type:n,selectors:[["bia-users-index"]],viewQuery:function(t,s){if(1&t&&(e.Gf(B.$,5),e.Gf(q,5)),2&t){let a;e.iGM(a=e.CRH())&&(s.biaTableComponent=a.first),e.iGM(a=e.CRH())&&(s.userTableComponent=a.first)}},hostVars:2,hostBindings:function(t,s){2&t&&e.ekj("bia-flex",s.flex)},decls:10,vars:18,consts:[["fxLayout","","fxLayout.xs","column","fxLayoutWrap","wrap"],["fxFlex","100"],[3,"headerTitle","canAdd","canDelete","canExportCSV","selectedElements","create","exportCSV","delete"],["pTemplate","actionOnList"],[3,"defaultPageSize","length","columns","columnToDisplays","tableStateKey","useViewTeamWithTypeId","displayedColumnsChange","filter","pageSizeChange","toggleSearch","viewChange"],[3,"elements","totalRecord","columnToDisplays","pageSize","configuration","showColSearch","globalSearchValue","canClickRow","canSelectElement","loading","viewPreference","tableStateKey","clickRow","loadLazy","selectedElementsChanged",4,"ngIf"],[3,"elements","dictOptionDtos","totalRecord","columnToDisplays","pageSize","configuration","showColSearch","globalSearchValue","canEdit","canAdd","canSelectElement","loading","viewPreference","tableStateKey","loadLazy","selectedElementsChanged","save",4,"ngIf"],[3,"display","displayChange"],["pButton","","class","p-button-outlined",3,"label","click",4,"ngIf"],["pButton","",1,"p-button-outlined",3,"label","click"],[3,"elements","totalRecord","columnToDisplays","pageSize","configuration","showColSearch","globalSearchValue","canClickRow","canSelectElement","loading","viewPreference","tableStateKey","clickRow","loadLazy","selectedElementsChanged"],[3,"elements","dictOptionDtos","totalRecord","columnToDisplays","pageSize","configuration","showColSearch","globalSearchValue","canEdit","canAdd","canSelectElement","loading","viewPreference","tableStateKey","loadLazy","selectedElementsChanged","save"]],template:function(t,s){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"bia-table-header",2),e.NdJ("create",function(){return s.onCreate()})("exportCSV",function(){return s.onExportCSV()})("delete",function(){return s.onDelete()}),e.ALo(3,"translate"),e.YNc(4,ht,1,1,"ng-template",3),e.qZA(),e.TgZ(5,"bia-table-controller",4),e.NdJ("displayedColumnsChange",function(r){return s.displayedColumnsChanged(r)})("filter",function(r){return s.searchGlobalChanged(r)})("pageSizeChange",function(r){return s.onPageSizeChange(r)})("toggleSearch",function(){return s.onToggleSearch()})("viewChange",function(r){return s.onViewChange(r)}),e.ALo(6,"async"),e.qZA(),e.YNc(7,gt,4,18,"bia-table",5),e.YNc(8,ft,5,22,"bia-user-table",6),e.qZA()(),e.TgZ(9,"bia-user-add-from-directory-dialog",7),e.NdJ("displayChange",function(r){return s.displayUserAddFromDirectoryDialog=r}),e.qZA()),2&t&&(e.xp6(2),e.Q6J("headerTitle",e.lcZ(3,14,"user.listOf"))("canAdd",s.canAdd&&!s.useCalcMode)("canDelete",s.canDelete)("canExportCSV",!0)("selectedElements",s.selectedUsers),e.xp6(3),e.Q6J("defaultPageSize",s.defaultPageSize)("length",e.lcZ(6,16,s.totalCount$))("columns",s.columns)("columnToDisplays",s.displayedColumns)("tableStateKey",s.tableStateKey)("useViewTeamWithTypeId",s.useViewTeamWithTypeId),e.xp6(2),e.Q6J("ngIf",!s.useCalcMode),e.xp6(1),e.Q6J("ngIf",s.useCalcMode),e.xp6(1),e.Q6J("display",s.displayUserAddFromDirectoryDialog))},directives:[A.xw,A.yH,ut.l,W.jx,m.O5,te.Hq,_t.B,B.$,q,dt.C],pipes:[E.X$,m.Ov],styles:["[_nghost-%COMP%]{flex-direction:column}bia-table-controller[_ngcontent-%COMP%]{margin-left:-35px;margin-right:-35px}"]}),n})();var vt=i(9417),Ct=i(6526);const yt=function(){return{width:"100%"}};let ne=(()=>{class n{constructor(t){this.formBuilder=t,this.user={},this.save=new e.vpe,this.cancel=new e.vpe,this.initForm()}ngOnChanges(t){this.user&&(this.form.reset(),this.user&&this.form.patchValue(Object.assign({},this.user)))}initForm(){this.form=this.formBuilder.group({id:[this.user.id],firstName:[this.user.firstName,_.kI.required],lastName:[this.user.lastName,_.kI.required],login:[this.user.login,_.kI.required],roles:[this.user.roles]})}onCancel(){this.form.reset(),this.cancel.next()}onSubmit(){var t;if(this.form.valid){const s=this.form.value;s.id=s.id>0?s.id:0,s.roles=j.P.Differential(s.roles,null===(t=this.user)||void 0===t?void 0:t.roles),this.save.emit(s),this.form.reset()}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(_.qu))},n.\u0275cmp=e.Xpm({type:n,selectors:[["bia-user-form"]],inputs:{user:"user",roleOptions:"roleOptions"},outputs:{save:"save",cancel:"cancel"},features:[e.TTD],decls:40,vars:25,consts:[["fxLayout","column",3,"formGroup","submit"],["fxLayout","row","fxLayoutAlign","center"],["fxFlex","90",1,"app-field-container"],[1,"p-float-label"],["formControlName","firstName","type","text","pInputText","","maxlength","64","disabled","true",2,"width","100%"],[1,"bia-star-mandatory"],["formControlName","lastName","type","text","pInputText","","maxlength","64","disabled","true",2,"width","100%"],["formControlName","login","type","text","pInputText","","maxlength","64","disabled","true",2,"width","100%"],["defaultLabel","\xa0","formControlName","roles","optionLabel","display","datakey","id","appendTo","body",3,"options","virtualScroll"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","end end"],["pButton","","type","submit",3,"label","disabled"],["pButton","","type","button",1,"p-button-outlined",3,"label","click"]],template:function(t,s){1&t&&(e.TgZ(0,"form",0),e.NdJ("submit",function(){return s.onSubmit()}),e.TgZ(1,"div",1)(2,"div",2)(3,"span",3),e._UZ(4,"input",4),e.TgZ(5,"label")(6,"span",5),e._uU(7,"*"),e.qZA(),e._uU(8),e.ALo(9,"translate"),e.qZA()()()(),e.TgZ(10,"div",1)(11,"div",2)(12,"span",3),e._UZ(13,"input",6),e.TgZ(14,"label")(15,"span",5),e._uU(16,"*"),e.qZA(),e._uU(17),e.ALo(18,"translate"),e.qZA()()()(),e.TgZ(19,"div",1)(20,"div",2)(21,"span",3),e._UZ(22,"input",7),e.TgZ(23,"label")(24,"span",5),e._uU(25,"*"),e.qZA(),e._uU(26),e.ALo(27,"translate"),e.qZA()()()(),e.TgZ(28,"div",1)(29,"div",2)(30,"span",3),e._UZ(31,"p-multiSelect",8),e.TgZ(32,"label"),e._uU(33),e.ALo(34,"translate"),e.qZA()()()(),e.TgZ(35,"div",9),e._UZ(36,"button",10),e.ALo(37,"translate"),e.TgZ(38,"button",11),e.NdJ("click",function(){return s.onCancel()}),e.ALo(39,"translate"),e.qZA()()()),2&t&&(e.Q6J("formGroup",s.form),e.xp6(8),e.Oqu(e.lcZ(9,12,"user.firstName")),e.xp6(9),e.Oqu(e.lcZ(18,14,"user.lastName")),e.xp6(9),e.Oqu(e.lcZ(27,16,"user.login")),e.xp6(5),e.Akn(e.DdM(24,yt)),e.Q6J("options",s.roleOptions)("virtualScroll",!0),e.xp6(2),e.Oqu(e.lcZ(34,18,"member.roles")),e.xp6(3),e.s9C("label",e.lcZ(37,20,"bia.save")),e.Q6J("disabled",!s.form.valid),e.xp6(2),e.s9C("label",e.lcZ(39,22,"bia.cancel")))},directives:[_._Y,_.JL,A.xw,_.sg,A.Wh,A.yH,_.Fj,_.JJ,_.u,X.o,_.nD,Ct.NU,A.SQ,te.Hq],pipes:[E.X$],styles:[".app-field-container[_ngcontent-%COMP%]{margin-bottom:20px}"]}),n})(),Tt=(()=>{class n{constructor(t,s,a,r,p){this.store=t,this.router=s,this.activatedRoute=a,this.userOptionsService=r,this.biaTranslationService=p,this.sub=new S.w}ngOnInit(){this.sub.add(this.biaTranslationService.currentCulture$.subscribe(t=>{this.userOptionsService.loadAllOptions()}))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}onSubmitted(t){this.store.dispatch(c.create({user:t})),this.router.navigate(["../"],{relativeTo:this.activatedRoute})}onCancelled(){this.router.navigate(["../"],{relativeTo:this.activatedRoute})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.yh),e.Y36(b.F0),e.Y36(b.gz),e.Y36(Y),e.Y36(P.P6))},n.\u0275cmp=e.Xpm({type:n,selectors:[["bia-user-new"]],decls:2,vars:3,consts:[[3,"roleOptions","cancel","save"]],template:function(t,s){1&t&&(e.TgZ(0,"bia-user-form",0),e.NdJ("cancel",function(){return s.onCancelled()})("save",function(r){return s.onSubmitted(r)}),e.ALo(1,"async"),e.qZA()),2&t&&e.Q6J("roleOptions",e.lcZ(1,1,s.userOptionsService.roleOptions$))},directives:[ne],pipes:[m.Ov],styles:[""]}),n})(),se=(()=>{class n{constructor(t){this.store=t,this.sub=new S.w,this.InitSub(),this.loading$=this.store.select(ge),this.user$=this.store.select(R)}get currentUser(){var t;return(null===(t=this._currentUser)||void 0===t?void 0:t.id)===this._currentUserId?this._currentUser:null}get currentUserId(){return this._currentUserId}set currentUserId(t){this._currentUserId=Number(t),this.store.dispatch(c.load({id:t}))}InitSub(){this.sub=new S.w,this.sub.add(this.store.select(R).subscribe(t=>{t&&(this._currentUser=t)}))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(l.yh))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var oe=i(9373);function xt(n,o){1&n&&e._UZ(0,"bia-spinner",2),2&n&&e.Q6J("overlay",!0)}let St=(()=>{class n{constructor(t,s,a,r,p,u){this.store=t,this.router=s,this.activatedRoute=a,this.userOptionsService=r,this.userService=p,this.biaTranslationService=u,this.displayChange=new e.vpe,this.sub=new S.w}ngOnInit(){this.sub.add(this.biaTranslationService.currentCulture$.subscribe(t=>{this.userOptionsService.loadAllOptions()}))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}onSubmitted(t){this.store.dispatch(c.update({user:t})),this.router.navigate(["../../"],{relativeTo:this.activatedRoute})}onCancelled(){this.router.navigate(["../../"],{relativeTo:this.activatedRoute})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.yh),e.Y36(b.F0),e.Y36(b.gz),e.Y36(Y),e.Y36(se),e.Y36(P.P6))},n.\u0275cmp=e.Xpm({type:n,selectors:[["bia-user-edit"]],outputs:{displayChange:"displayChange"},decls:5,vars:9,consts:[[3,"user","roleOptions","cancel","save"],[3,"overlay",4,"ngIf"],[3,"overlay"]],template:function(t,s){1&t&&(e.TgZ(0,"bia-user-form",0),e.NdJ("cancel",function(){return s.onCancelled()})("save",function(r){return s.onSubmitted(r)}),e.ALo(1,"async"),e.ALo(2,"async"),e.qZA(),e.YNc(3,xt,1,1,"bia-spinner",1),e.ALo(4,"async")),2&t&&(e.Q6J("user",e.lcZ(1,3,s.userService.user$))("roleOptions",e.lcZ(2,5,s.userOptionsService.roleOptions$)),e.xp6(3),e.Q6J("ngIf",e.lcZ(4,7,s.userService.loading$)))},directives:[ne,m.O5,oe.O],pipes:[m.Ov],styles:[""]}),n})();var z=i(6249),Ut=i(466);function wt(n,o){1&n&&e._UZ(0,"bia-spinner",1),2&n&&e.Q6J("overlay",!0)}let It=(()=>{class n{constructor(t,s,a,r){this.store=t,this.route=s,this.userService=a,this.layoutService=r,this.sub=new S.w}ngOnInit(){this.userService.currentUserId=this.route.snapshot.params.userId,this.sub.add(this.store.select(R).subscribe(t=>{(null==t?void 0:t.displayName)&&(this.route.data.pipe((0,V.P)()).subscribe(s=>{s.breadcrumb=t.displayName}),this.layoutService.refreshBreadcrumb())}))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(l.yh),e.Y36(b.gz),e.Y36(se),e.Y36(Ut.N))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],decls:3,vars:3,consts:[[3,"overlay",4,"ngIf"],[3,"overlay"]],template:function(t,s){1&t&&(e._UZ(0,"router-outlet"),e.YNc(1,wt,1,1,"bia-spinner",0),e.ALo(2,"async")),2&t&&(e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,s.userService.loading$)))},directives:[b.lC,m.O5,oe.O],pipes:[m.Ov],styles:[""]}),n})();var ae=i(8832),J=i(3460),At=i(2566),Lt=i(3822);const Ot=[{path:"",data:{breadcrumb:null,permission:U.y.User_List_Access,InjectComponent:bt},component:J.e,canActivate:[z.n],children:[{path:"create",data:{breadcrumb:"bia.add",canNavigate:!1,permission:U.y.User_Add,title:"user.add",InjectComponent:Tt},component:ae._,canActivate:[z.n]},{path:":userId",data:{breadcrumb:"",canNavigate:!0},component:It,canActivate:[z.n],children:[{path:"edit",data:{breadcrumb:"bia.edit",canNavigate:!0,permission:U.y.User_UpdateRoles,title:"user.edit",InjectComponent:St},component:ae._,canActivate:[z.n]},{path:"",redirectTo:"edit"}]}]},{path:"**",redirectTo:""}];let Zt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[vt.m,b.Bz.forChild(Ot),l.Aw.forFeature(g,de),d.sQ.forFeature([ve]),At.p,Lt.q]]}),n})()}}]);