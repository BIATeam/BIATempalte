"use strict";(self.webpackChunkBIATemplate=self.webpackChunkBIATemplate||[]).push([[562],{562:(Kt,B,r)=>{r.r(B),r.d(B,{SiteMemberModule:()=>Ut});var c,n,h=r(4490),F=r(1564),D=r(9716),l=r(5094),ue=r(5685);(n=c||(c={})).loadAllByPost=(0,l.PH)("[Members] Load all by post",(0,l.Ky)()),n.load=(0,l.PH)("[Members] Load",(0,l.Ky)()),n.create=(0,l.PH)("[Members] Create",(0,l.Ky)()),n.createMulti=(0,l.PH)("[Members] Create multi",(0,l.Ky)()),n.update=(0,l.PH)("[Members] Update",(0,l.Ky)()),n.remove=(0,l.PH)("[Members] Remove",(0,l.Ky)()),n.multiRemove=(0,l.PH)("[Members] Multi Remove",(0,l.Ky)()),n.loadAllByPostSuccess=(0,l.PH)("[Members] Load all by post success",(0,l.Ky)()),n.loadSuccess=(0,l.PH)("[Members] Load success",(0,l.Ky)()),n.failure=(0,l.PH)("[Members] Failure",(0,l.Ky)());const $=(0,ue.H)({selectId:n=>n.id,sortComparer:!1}),_e=$.getInitialState({totalCount:0,currentMember:{},lastLazyLoadEvent:{},loadingGet:!1,loadingGetAll:!1}),be=(0,l.Lq)(_e,(0,l.on)(c.loadAllByPost,(n,{})=>Object.assign(Object.assign({},n),{loadingGetAll:!0})),(0,l.on)(c.load,n=>Object.assign(Object.assign({},n),{loadingGet:!0})),(0,l.on)(c.loadAllByPostSuccess,(n,{result:a,event:t})=>{const o=$.setAll(a.data,n);return o.totalCount=a.totalCount,o.lastLazyLoadEvent=t,o.loadingGetAll=!1,o}),(0,l.on)(c.loadSuccess,(n,{member:a})=>Object.assign(Object.assign({},n),{currentMember:a,loadingGet:!1})),(0,l.on)(c.failure,(n,{})=>Object.assign(Object.assign({},n),{loadingGetAll:!1,loadingGet:!1})));function ge(n,a){return(0,l.UY)({members:be})(n,a)}const he=(0,l.ZF)("members"),x=(0,l.P1)(he,n=>n.members),fe=(0,l.P1)(x,n=>n.totalCount),Q=(0,l.P1)(x,n=>n.currentMember),I=(0,l.P1)(x,n=>n.lastLazyLoadEvent),Ce=(0,l.P1)(x,n=>n.loadingGet),ve=(0,l.P1)(x,n=>n.loadingGetAll),{selectAll:ye}=$.getSelectors(x);var f=r(2654),Y=r(8385),E=r(9157),N=r(136),Se=r(4016),e=r(5e3);let V=(()=>{class n extends Se.Z{constructor(t){super(t,"Members")}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(e.zs3))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Me=r(9441),C=r(7171),xe=r(8042),j=r(7224),Te=r(7145);let we=(()=>{class n{constructor(t,o){this.store=t,this.signalRService=o}initialize(t){console.log("%c [Members] Register SignalR : refresh-members","color: purple; font-weight: bold"),this.signalRService.addMethod("refresh-members",()=>{this.store.select(I).pipe((0,j.P)()).subscribe(o=>{console.log("%c [Members] RefreshSuccess","color: green; font-weight: bold"),this.store.dispatch(c.loadAllByPost({event:o}))})}),this.targetedFeature={parentKey:t,featureName:"members"},this.signalRService.joinGroup(this.targetedFeature)}destroy(){console.log("%c [Members] Unregister SignalR : refresh-members","color: purple; font-weight: bold"),this.signalRService.removeMethod("refresh-members"),this.signalRService.leaveGroup(this.targetedFeature)}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(l.yh),e.LFG(Te.Y))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var b=r(1086),T=r(373),w=r(7545),S=r(4850),A=r(7221),O=r(1406),L=r(7168),_=r(6517),Z=r(2762),X=r(42);let U=(()=>{class n{constructor(t,o,i,s){this.actions$=t,this.memberDas=o,this.biaMessageService=i,this.store=s,this.loadAllByPost$=(0,_.GW)(()=>this.actions$.pipe((0,_.l4)(c.loadAllByPost),(0,T.j)("event"),(0,w.w)(m=>this.memberDas.getListByPost({event:m}).pipe((0,S.U)(u=>c.loadAllByPostSuccess({result:u,event:m})),(0,A.K)(u=>(this.biaMessageService.showError(),(0,b.of)(c.failure({error:u})))))))),this.load$=(0,_.GW)(()=>this.actions$.pipe((0,_.l4)(c.load),(0,T.j)("id"),(0,w.w)(m=>this.memberDas.get({id:m}).pipe((0,S.U)(u=>c.loadSuccess({member:u})),(0,A.K)(u=>(this.biaMessageService.showError(),(0,b.of)(c.failure({error:u})))))))),this.create$=(0,_.GW)(()=>this.actions$.pipe((0,_.l4)(c.create),(0,T.j)("member"),(0,O.b)(m=>(0,b.of)(m).pipe((0,L.M)(this.store.select(I)))),(0,w.w)(([m,u])=>this.memberDas.post({item:m}).pipe((0,S.U)(()=>(this.biaMessageService.showAddSuccess(),n.useSignalR?(0,Z.b)():c.loadAllByPost({event:u}))),(0,A.K)(y=>(this.biaMessageService.showError(),(0,b.of)(c.failure({error:y})))))))),this.createMulti$=(0,_.GW)(()=>this.actions$.pipe((0,_.l4)(c.createMulti),(0,T.j)("members"),(0,O.b)(m=>(0,b.of)(m).pipe((0,L.M)(this.store.select(I)))),(0,w.w)(([m,u])=>this.memberDas.postItem({item:m,endpoint:"addMulti"}).pipe((0,S.U)(()=>(this.biaMessageService.showAddSuccess(),n.useSignalR?(0,Z.b)():c.loadAllByPost({event:u}))),(0,A.K)(y=>(this.biaMessageService.showError(),(0,b.of)(c.failure({error:y})))))))),this.update$=(0,_.GW)(()=>this.actions$.pipe((0,_.l4)(c.update),(0,T.j)("member"),(0,O.b)(m=>(0,b.of)(m).pipe((0,L.M)(this.store.select(I)))),(0,w.w)(([m,u])=>this.memberDas.put({item:m,id:m.id}).pipe((0,S.U)(()=>(this.biaMessageService.showUpdateSuccess(),n.useSignalR?(0,Z.b)():c.loadAllByPost({event:u}))),(0,A.K)(y=>(this.biaMessageService.showError(),(0,b.of)(c.failure({error:y})))))))),this.destroy$=(0,_.GW)(()=>this.actions$.pipe((0,_.l4)(c.remove),(0,T.j)("id"),(0,O.b)(m=>(0,b.of)(m).pipe((0,L.M)(this.store.select(I)))),(0,w.w)(([m,u])=>this.memberDas.delete({id:m}).pipe((0,S.U)(()=>(this.biaMessageService.showDeleteSuccess(),n.useSignalR?(0,Z.b)():c.loadAllByPost({event:u}))),(0,A.K)(y=>(this.biaMessageService.showError(),(0,b.of)(c.failure({error:y})))))))),this.multiDestroy$=(0,_.GW)(()=>this.actions$.pipe((0,_.l4)(c.multiRemove),(0,T.j)("ids"),(0,O.b)(m=>(0,b.of)(m).pipe((0,L.M)(this.store.select(I)))),(0,w.w)(([m,u])=>this.memberDas.deletes({ids:m}).pipe((0,S.U)(()=>(this.biaMessageService.showDeleteSuccess(),n.useSignalR?(0,Z.b)():c.loadAllByPost({event:u}))),(0,A.K)(y=>(this.biaMessageService.showError(),(0,b.of)(c.failure({error:y}))))))))}}return n.useSignalR=!1,n.\u0275fac=function(t){return new(t||n)(e.LFG(_.eX),e.LFG(V),e.LFG(X.X),e.LFG(l.yh))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac}),n})();var Ae=r(6468),Ie=r(6053),Oe=r(5424),Le=r(6875),J=r(5863),k=r(6048),W=r(4529);let K=(()=>{class n{constructor(t){this.store=t,this.userOptions$=this.store.select(J.yp),this.roleOptions$=this.store.select(Oe.wA),this.dictOptionDtos$=(0,Ie.aj)([this.userOptions$,this.roleOptions$]).pipe((0,S.U)(o=>[new W.b("user",o[0]),new W.b("roles",o[1])]))}loadAllOptions(t){this.store.dispatch(k.d.loadAll()),this.store.dispatch(Le.E.loadAll({teamTypeId:t}))}refreshUsersOptions(){this.store.dispatch(k.d.loadAll())}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(l.yh))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var Ze=r(8928),G=r(1307),g=r(277),q=r(1606),ee=r(6743),p=r(9808),d=r(3075),R=r(1466),Fe=r(6320),v=r(4851),De=r(9783),Ee=r(1424),Ne=r(4784),Je=r(8786),Re=r(2081);function ze(n,a){1&n&&(e.TgZ(0,"th",10),e._UZ(1,"p-tableHeaderCheckbox"),e.qZA())}function Pe(n,a){if(1&n&&(e.TgZ(0,"th",13),e._uU(1),e.ALo(2,"translate"),e._UZ(3,"p-sortIcon",14),e.qZA()),2&n){const t=e.oxw().$implicit;e.Q6J("pSortableColumn",t.field),e.xp6(1),e.hij(" ",e.lcZ(2,3,null==t?null:t.header)," "),e.xp6(2),e.Q6J("field",t.field)}}function $e(n,a){if(1&n&&(e.TgZ(0,"th",15),e._uU(1),e.ALo(2,"translate"),e.qZA()),2&n){const t=e.oxw().$implicit;e.xp6(1),e.hij(" ",e.lcZ(2,1,null==t?null:t.header)," ")}}function Qe(n,a){if(1&n&&(e.ynx(0),e.YNc(1,Pe,4,5,"th",11),e.YNc(2,$e,3,3,"th",12),e.BQk()),2&n){const t=a.$implicit;e.xp6(1),e.Q6J("ngIf",!0===(null==t?null:t.isSortable)),e.xp6(1),e.Q6J("ngIf",!0!==(null==t?null:t.isSortable))}}function Ye(n,a){1&n&&e._UZ(0,"th")}const Ue=function(n){return{"p-state-filled":n}};function Ke(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"span",21)(1,"input",22),e.NdJ("input",function(i){e.CHM(t);const s=e.oxw().$implicit;return e.oxw(3),e.MAs(1).filter(i.target.value,s.field,s.filterMode)}),e.ALo(2,"translate"),e.qZA()()}if(2&n){const t=e.oxw().$implicit;e.oxw(3);const o=e.MAs(1);e.xp6(1),e.s9C("type","Number"===t.type?"number":"text"),e.s9C("placeholder",void 0!==t.searchPlaceholder?t.searchPlaceholder:!0===t.isDate?e.lcZ(2,4,"bia.dateIso8601"):""),e.Q6J("value",null==o.filters[t.field]?null:o.filters[t.field].value)("ngClass",e.VKq(6,Ue,""!==(null==o.filters[t.field]?null:o.filters[t.field].value)))}}function Ge(n,a){if(1&n&&(e.TgZ(0,"th",19),e.YNc(1,Ke,3,8,"span",20),e.qZA()),2&n){const t=a.$implicit;e.Q6J("ngSwitch",t.field),e.xp6(1),e.Q6J("ngIf",!0===t.isSearchable)}}function He(n,a){if(1&n&&(e.TgZ(0,"tr",16),e.YNc(1,Ye,1,0,"th",17),e.YNc(2,Ge,2,2,"th",18),e.qZA()),2&n){const t=e.oxw().$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("ngIf",o.canSelectElement),e.xp6(1),e.Q6J("ngForOf",t)}}function Be(n,a){if(1&n&&(e.TgZ(0,"tr"),e.YNc(1,ze,2,0,"th",7),e.YNc(2,Qe,3,2,"ng-container",8),e.qZA(),e.YNc(3,He,3,2,"tr",9)),2&n){const t=a.$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("ngIf",o.canSelectElement),e.xp6(1),e.Q6J("ngForOf",t),e.xp6(1),e.Q6J("ngIf",o.showColSearch)}}function Ve(n,a){if(1&n&&e._UZ(0,"p-tableCheckbox",27),2&n){const t=e.oxw(2).$implicit;e.Q6J("value",t)}}function je(n,a){1&n&&e._UZ(0,"i",28)}function Xe(n,a){if(1&n&&(e.TgZ(0,"td"),e.YNc(1,Ve,1,1,"p-tableCheckbox",25),e.YNc(2,je,1,0,"i",26),e.qZA()),2&n){const t=e.oxw().$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("ngIf",!0!==o.isFooter(t)&&t.id>0),e.xp6(1),e.Q6J("ngIf",!0===o.isFooter(t))}}function ke(n,a){1&n&&e.GkF(0)}const We=function(n,a){return{field:n,form:a}};function qe(n,a){if(1&n&&e.YNc(0,ke,1,0,"ng-container",36),2&n){const t=e.oxw(3).$implicit,o=e.oxw(3);e.Q6J("ngTemplateOutlet",o.specificInputTemplate)("ngTemplateOutletContext",e.WLB(2,We,t,o.form))}}function et(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"bia-table-input",34),e.NdJ("valueChange",function(){return e.CHM(t),e.oxw(5).onChange()})("complexInput",function(i){return e.CHM(t),e.oxw(5).onComplexInput(i)}),e.YNc(1,qe,1,5,"ng-template",35),e.qZA()}if(2&n){const t=e.oxw(2).$implicit,o=e.oxw(3);e.Q6J("field",t)("form",o.form)("dictOptionDtos",o.dictOptionDtos)}}function tt(n,a){1&n&&e.GkF(0)}const te=function(n,a){return{field:n,data:a}};function nt(n,a){if(1&n&&e.YNc(0,tt,1,0,"ng-container",36),2&n){const t=e.oxw(4).$implicit,o=e.oxw().$implicit,i=e.oxw(2);e.Q6J("ngTemplateOutlet",i.specificOutputTemplate)("ngTemplateOutletContext",e.WLB(2,te,t,i.getCellData(o,t)))}}function ot(n,a){if(1&n&&(e.ynx(0),e.TgZ(1,"bia-table-output",37),e.YNc(2,nt,1,5,"ng-template",38),e.qZA(),e.BQk()),2&n){const t=e.oxw(3).$implicit,o=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("field",t)("data",i.getCellData(o,t))}}function at(n,a){if(1&n&&e.YNc(0,ot,3,2,"ng-container",17),2&n){const t=e.oxw(3).$implicit,o=e.oxw(2);e.Q6J("ngIf",!0!==o.isFooter(t))}}function it(n,a){if(1&n&&(e.YNc(0,et,2,3,"ng-template",32),e.YNc(1,at,1,1,"ng-template",null,33,e.W1O)),2&n){const t=e.MAs(2),o=e.oxw().$implicit;e.Q6J("ngIf",!0===o.isEditable)("ngIfElse",t)}}function rt(n,a){1&n&&(e.TgZ(0,"label"),e._uU(1,"-"),e.qZA())}function st(n,a){if(1&n&&e.YNc(0,rt,2,0,"label",17),2&n){const t=e.oxw(2).$implicit;e.Q6J("ngIf",!0===t.isEditable)}}function lt(n,a){1&n&&e.GkF(0)}function ct(n,a){if(1&n&&e.YNc(0,lt,1,0,"ng-container",36),2&n){const t=e.oxw(3).$implicit,o=e.oxw().$implicit,i=e.oxw(2);e.Q6J("ngTemplateOutlet",i.specificOutputTemplate)("ngTemplateOutletContext",e.WLB(2,te,t,i.getCellData(o,t)))}}function mt(n,a){if(1&n&&(e.TgZ(0,"bia-table-output",37),e.YNc(1,ct,1,5,"ng-template",38),e.qZA()),2&n){const t=e.oxw(2).$implicit,o=e.oxw().$implicit,i=e.oxw(2);e.Q6J("field",t)("data",i.getCellData(o,t))}}function pt(n,a){if(1&n&&(e.YNc(0,st,1,1,"ng-template",32),e.YNc(1,mt,2,2,"ng-template",null,39,e.W1O)),2&n){const t=e.MAs(2),o=e.oxw(2).$implicit,i=e.oxw(2);e.Q6J("ngIf",!0===i.isFooter(o))("ngIfElse",t)}}function dt(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"td",29),e.NdJ("click",function(){e.CHM(t);const i=e.oxw().$implicit;return e.oxw(2).initEditableRow(i)}),e.TgZ(1,"p-cellEditor"),e.YNc(2,it,3,2,"ng-template",30),e.YNc(3,pt,3,2,"ng-template",31),e.qZA()()}}function ut(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"tr",23),e.NdJ("focusout",function(){return e.CHM(t),e.oxw(2).onFocusout()})("keyup.enter",function(){return e.CHM(t),e.oxw(2).initEditableRow(null)})("keyup.escape",function(){return e.CHM(t),e.oxw(2).cancel()}),e.YNc(1,Xe,3,2,"td",17),e.YNc(2,dt,4,0,"td",24),e.qZA()}if(2&n){const t=a.$implicit,o=a.columns,i=e.oxw(2);e.Q6J("pSelectableRow",!0!==i.isFooter(t)?t:null)("pEditableRow",t),e.xp6(1),e.Q6J("ngIf",i.canSelectElement),e.xp6(1),e.Q6J("ngForOf",o)}}function _t(n,a){if(1&n&&(e.TgZ(0,"tr")(1,"td",40),e._uU(2),e.ALo(3,"translate"),e.qZA()()),2&n){const t=a.$implicit;e.xp6(1),e.uIk("colspan",t.length+1),e.xp6(1),e.hij(" ",e.lcZ(3,2,"bia.NoRecordsFound")," ")}}function bt(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"p-table",2,3),e.NdJ("onFilter",function(){return e.CHM(t),e.oxw().onFilter()})("onLazyLoad",function(i){return e.CHM(t),e.oxw().onLoadLazy(i)})("onStateSave",function(i){return e.CHM(t),e.oxw().onStateSave(i)})("selectionChange",function(){return e.CHM(t),e.oxw().onSelectionChange()}),e.ALo(2,"async"),e.YNc(3,Be,4,3,"ng-template",4),e.YNc(4,ut,3,4,"ng-template",5),e.YNc(5,_t,4,4,"ng-template",6),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("autoLayout",!0)("reorderableColumns",!0)("columns",t.displayedColumns)("value",t.elements)("paginator",t.paginator)("rows",t.pageSize)("totalRecords",t.totalRecord)("lazy",!0)("loading",t.loading&&null!==e.lcZ(2,14,t.showLoading$))("stateStorage","session")("stateKey",t.tableStateKey)("lazyLoadOnInit",t.getLazyLoadOnInit())("sortField",t.sortFieldValue)("sortOrder",t.sortOrderValue)}}let ne=(()=>{class n extends Fe.l{constructor(t,o,i,s,m){super(t,o,i,s),this.formBuilder=t,this.authService=o,this.biaMessageService=i,this.translateService=s,this.siteService=m}initForm(){this.form=this.formBuilder.group({id:[this.element.id],user:[this.element.user,d.kI.required],roles:[this.element.roles]})}onSubmit(){var t;if(this.form.valid){const o=this.form.value;o.id=o.id>0?o.id:0,o.roles=R.P.Differential(o.roles,null===(t=this.element)||void 0===t?void 0:t.roles),o.user=Object.assign({},o.user),o.teamId=this.siteService.currentSiteId,this.save.emit(o),this.form.reset()}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(d.qu),e.Y36(F.e),e.Y36(X.X),e.Y36(C.sK),e.Y36(D.P))},n.\u0275cmp=e.Xpm({type:n,selectors:[["bia-member-table"]],features:[e.qOj],decls:2,vars:2,consts:[[1,"bia-calc-form",3,"formGroup"],["editMode","row","dataKey","id","styleClass","p-datatable-striped",3,"autoLayout","reorderableColumns","columns","value","paginator","rows","totalRecords","lazy","loading","stateStorage","stateKey","lazyLoadOnInit","sortField","sortOrder","onFilter","onLazyLoad","onStateSave","selectionChange",4,"ngIf"],["editMode","row","dataKey","id","styleClass","p-datatable-striped",3,"autoLayout","reorderableColumns","columns","value","paginator","rows","totalRecords","lazy","loading","stateStorage","stateKey","lazyLoadOnInit","sortField","sortOrder","onFilter","onLazyLoad","onStateSave","selectionChange"],["dt",""],["pTemplate","header"],["pTemplate","body"],["pTemplate","emptymessage"],["class","bia-table-select-col",4,"ngIf"],[4,"ngFor","ngForOf"],["class","searchTR",4,"ngIf"],[1,"bia-table-select-col"],["pReorderableColumn","",3,"pSortableColumn",4,"ngIf"],["pReorderableColumn","",4,"ngIf"],["pReorderableColumn","",3,"pSortableColumn"],[3,"field"],["pReorderableColumn",""],[1,"searchTR"],[4,"ngIf"],["pReorderableColumn","",3,"ngSwitch",4,"ngFor","ngForOf"],["pReorderableColumn","",3,"ngSwitch"],["class","p-float-label",4,"ngIf"],[1,"p-float-label"],["pInputText","",1,"input-search",3,"type","placeholder","value","ngClass","input"],[3,"pSelectableRow","pEditableRow","focusout","keyup.enter","keyup.escape"],[3,"click",4,"ngFor","ngForOf"],[3,"value",4,"ngIf"],["class","pi pi-plus",4,"ngIf"],[3,"value"],[1,"pi","pi-plus"],[3,"click"],["pTemplate","input"],["pTemplate","output"],[3,"ngIf","ngIfElse"],["isNotEditable",""],[3,"field","form","dictOptionDtos","valueChange","complexInput"],["pTemplate","specificInput"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[3,"field","data"],["pTemplate","specificOutput"],["editRow",""],[1,"app-empty-message"]],template:function(t,o){1&t&&(e.TgZ(0,"form",0),e.YNc(1,bt,6,16,"p-table",1),e.qZA()),2&t&&(e.Q6J("formGroup",o.form),e.xp6(1),e.Q6J("ngIf",o.configuration))},directives:[d._Y,d.JL,d.sg,p.O5,v.iA,De.jx,v.Mo,p.sg,v.Af,v.lQ,v.fz,p.RF,Ee.o,p.mk,Ne.oO,v.Ei,v.D$,v.UA,v.YL,Je.P,p.tP,Re.T],pipes:[p.Ov,C.X$],styles:["[_nghost-%COMP%]{flex-direction:column}[_nghost-%COMP%]     p-table .searchTR .p-float-label .p-inputtext{padding-top:2px!important}.input-search[_ngcontent-%COMP%]{width:99%}.app-empty-message[_ngcontent-%COMP%]{text-align:center!important}table[_ngcontent-%COMP%]{width:100%}.bia-table-select-col[_ngcontent-%COMP%]{width:60px}"]}),n})();function gt(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"bia-table",6),e.NdJ("clickRow",function(i){return e.CHM(t),e.oxw().onEdit(i)})("loadLazy",function(i){return e.CHM(t),e.oxw().onLoadLazy(i)})("selectedElementsChanged",function(i){return e.CHM(t),e.oxw().onSelectedElementsChanged(i)}),e.ALo(1,"async"),e.ALo(2,"async"),e.ALo(3,"async"),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("elements",e.lcZ(1,12,t.members$))("totalRecord",e.lcZ(2,14,t.totalCount$))("columnToDisplays",t.displayedColumns)("pageSize",t.pageSize)("configuration",t.tableConfiguration)("showColSearch",t.showColSearch)("globalSearchValue",t.globalSearchValue)("canClickRow",t.canEdit)("canSelectElement",t.canDelete)("loading",e.lcZ(3,16,t.loading$))("viewPreference",t.viewPreference)("tableStateKey",t.tableStateKey)}}function ht(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"bia-member-table",7),e.NdJ("loadLazy",function(i){return e.CHM(t),e.oxw().onLoadLazy(i)})("selectedElementsChanged",function(i){return e.CHM(t),e.oxw().onSelectedElementsChanged(i)})("save",function(i){return e.CHM(t),e.oxw().onSave(i)}),e.ALo(1,"async"),e.ALo(2,"async"),e.ALo(3,"async"),e.ALo(4,"async"),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("elements",e.lcZ(1,14,t.members$))("dictOptionDtos",e.lcZ(2,16,t.memberOptionsService.dictOptionDtos$))("totalRecord",e.lcZ(3,18,t.totalCount$))("columnToDisplays",t.displayedColumns)("pageSize",t.pageSize)("configuration",t.tableConfiguration)("showColSearch",t.showColSearch)("globalSearchValue",t.globalSearchValue)("canEdit",t.canEdit)("canAdd",t.canAdd)("canSelectElement",t.canDelete)("loading",e.lcZ(4,20,t.loading$))("viewPreference",t.viewPreference)("tableStateKey",t.tableStateKey)}}let ft=(()=>{class n{constructor(t){this.useCalcMode=!1,this.useSignalR=!1,this.useView=!1,this.useRefreshAtLanguageChange=!0,this.flex=!0,this.sub=new f.w,this.showColSearch=!1,this.globalSearchValue="",this.defaultPageSize=N.L8,this.pageSize=this.defaultPageSize,this.canEdit=!1,this.canDelete=!1,this.canAdd=!1,this.tableStateKey=this.useView?"membersGrid":void 0,this.store=t.get(l.yh),this.router=t.get(h.F0),this.activatedRoute=t.get(h.gz),this.memberDas=t.get(V),this.translateService=t.get(C.sK),this.biaTranslationService=t.get(xe.P6),this.membersSignalRService=t.get(we),this.useCalcMode&&(this.memberOptionsService=t.get(K))}ngOnInit(){this.sub=new f.w,this.initTableConfiguration(),this.teams$=this.store.select((0,Ze.sf)(this.teamTypeId)),this.sub.add(this.teams$.subscribe(()=>{this.setPermissions()})),this.members$=this.store.select(ye),this.totalCount$=this.store.select(fe),this.loading$=this.store.select(ve),this.OnDisplay(),this.useCalcMode&&(this.memberOptionsService.loadAllOptions(this.teamTypeId),this.sub.add(this.store.select(J.nC).subscribe(t=>{this.memberOptionsService.refreshUsersOptions()}))),this.useRefreshAtLanguageChange&&this.sub.add(this.biaTranslationService.currentCulture$.pipe((0,G.T)(1)).subscribe(t=>{this.onLoadLazy(this.memberListComponent.getLazyLoadMetadata())}))}ngOnDestroy(){this.sub&&this.sub.unsubscribe(),this.OnHide()}OnDisplay(){this.useView&&this.store.dispatch((0,Ae.Tx)()),this.useSignalR&&(this.membersSignalRService.initialize(this.parentIds[0]),U.useSignalR=!0)}OnHide(){this.useSignalR&&(U.useSignalR=!1,this.membersSignalRService.destroy())}onCreate(){this.useCalcMode||this.router.navigate(["../create"],{relativeTo:this.activatedRoute})}onEdit(t){this.useCalcMode||this.router.navigate(["../"+t+"/edit"],{relativeTo:this.activatedRoute})}onSave(t){this.useCalcMode&&((null==t?void 0:t.id)>0?this.canEdit&&this.store.dispatch(c.update({member:t})):this.canAdd&&this.store.dispatch(c.create({member:t})))}onDelete(){this.selectedMembers&&this.canDelete&&this.store.dispatch(c.multiRemove({ids:this.selectedMembers.map(t=>t.id)}))}onSelectedElementsChanged(t){this.selectedMembers=t}onPageSizeChange(t){this.pageSize=t}onLoadLazy(t){const o=Object.assign({parentIds:this.parentIds},t);this.store.dispatch(c.loadAllByPost({event:o}))}searchGlobalChanged(t){this.globalSearchValue=t}displayedColumnsChanged(t){this.displayedColumns=t}onToggleSearch(){this.showColSearch=!this.showColSearch}onViewChange(t){this.viewPreference=t}onExportCSV(){const t={};this.memberListComponent.getPrimeNgTable().columns.map(i=>t[i.field]=this.translateService.instant(i.header));const o=Object.assign({parentIds:this.parentIds,columns:t},this.memberListComponent.getLazyLoadMetadata());this.memberDas.getFile(o).subscribe(i=>{Me.saveAs(i,this.translateService.instant("app.members")+".csv")})}setPermissions(){}initTableConfiguration(){this.sub.add(this.biaTranslationService.currentCultureDateFormat$.subscribe(t=>{this.tableConfiguration={columns:[Object.assign(new E.kc("user","member.user"),{type:E.d5.OneToMany}),Object.assign(new E.kc("roles","member.rolesForSite"),{type:E.d5.ManyToMany})]},this.columns=this.tableConfiguration.columns.map(o=>({key:o.field,value:o.header})),this.displayedColumns=[...this.columns]}))}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["bia-members-index"]],viewQuery:function(t,o){if(1&t&&e.Gf(Y.$,5),2&t){let i;e.iGM(i=e.CRH())&&(o.memberListComponent=i.first)}},hostVars:2,hostBindings:function(t,o){2&t&&e.ekj("bia-flex",o.flex)},decls:8,vars:16,consts:[["fxLayout","","fxLayout.xs","column","fxLayoutWrap","wrap"],["fxFlex","100"],[3,"headerTitle","canAdd","canDelete","canExportCSV","selectedElements","create","exportCSV","delete"],[3,"defaultPageSize","length","columns","columnToDisplays","tableStateKey","displayedColumnsChange","filter","pageSizeChange","toggleSearch","viewChange"],[3,"elements","totalRecord","columnToDisplays","pageSize","configuration","showColSearch","globalSearchValue","canClickRow","canSelectElement","loading","viewPreference","tableStateKey","clickRow","loadLazy","selectedElementsChanged",4,"ngIf"],[3,"elements","dictOptionDtos","totalRecord","columnToDisplays","pageSize","configuration","showColSearch","globalSearchValue","canEdit","canAdd","canSelectElement","loading","viewPreference","tableStateKey","loadLazy","selectedElementsChanged","save",4,"ngIf"],[3,"elements","totalRecord","columnToDisplays","pageSize","configuration","showColSearch","globalSearchValue","canClickRow","canSelectElement","loading","viewPreference","tableStateKey","clickRow","loadLazy","selectedElementsChanged"],[3,"elements","dictOptionDtos","totalRecord","columnToDisplays","pageSize","configuration","showColSearch","globalSearchValue","canEdit","canAdd","canSelectElement","loading","viewPreference","tableStateKey","loadLazy","selectedElementsChanged","save"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"bia-table-header",2),e.NdJ("create",function(){return o.onCreate()})("exportCSV",function(){return o.onExportCSV()})("delete",function(){return o.onDelete()}),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"bia-table-controller",3),e.NdJ("displayedColumnsChange",function(s){return o.displayedColumnsChanged(s)})("filter",function(s){return o.searchGlobalChanged(s)})("pageSizeChange",function(s){return o.onPageSizeChange(s)})("toggleSearch",function(){return o.onToggleSearch()})("viewChange",function(s){return o.onViewChange(s)}),e.ALo(5,"async"),e.qZA(),e.YNc(6,gt,4,18,"bia-table",4),e.YNc(7,ht,5,22,"bia-member-table",5),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("headerTitle",e.lcZ(3,12,"member.listOfSiteMembers"))("canAdd",o.canAdd&&!o.useCalcMode)("canDelete",o.canDelete)("canExportCSV",!0)("selectedElements",o.selectedMembers),e.xp6(2),e.Q6J("defaultPageSize",o.defaultPageSize)("length",e.lcZ(5,14,o.totalCount$))("columns",o.columns)("columnToDisplays",o.displayedColumns)("tableStateKey",o.tableStateKey),e.xp6(2),e.Q6J("ngIf",!o.useCalcMode),e.xp6(1),e.Q6J("ngIf",o.useCalcMode))},directives:[g.xw,g.yH,q.l,ee.B,p.O5,Y.$,ne],pipes:[C.X$,p.Ov],styles:["[_nghost-%COMP%]{flex-direction:column}bia-table-controller[_ngcontent-%COMP%]{margin-left:-35px;margin-right:-35px}"]}),n})();var M=r(9206);function Ct(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"bia-table",6),e.NdJ("clickRow",function(i){return e.CHM(t),e.oxw().onEdit(i)})("loadLazy",function(i){return e.CHM(t),e.oxw().onLoadLazy(i)})("selectedElementsChanged",function(i){return e.CHM(t),e.oxw().onSelectedElementsChanged(i)}),e.ALo(1,"async"),e.ALo(2,"async"),e.ALo(3,"async"),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("elements",e.lcZ(1,12,t.members$))("totalRecord",e.lcZ(2,14,t.totalCount$))("columnToDisplays",t.displayedColumns)("pageSize",t.pageSize)("configuration",t.tableConfiguration)("showColSearch",t.showColSearch)("globalSearchValue",t.globalSearchValue)("canClickRow",t.canEdit)("canSelectElement",t.canDelete)("loading",e.lcZ(3,16,t.loading$))("viewPreference",t.viewPreference)("tableStateKey",t.tableStateKey)}}function vt(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"bia-member-table",7),e.NdJ("loadLazy",function(i){return e.CHM(t),e.oxw().onLoadLazy(i)})("selectedElementsChanged",function(i){return e.CHM(t),e.oxw().onSelectedElementsChanged(i)})("save",function(i){return e.CHM(t),e.oxw().onSave(i)}),e.ALo(1,"async"),e.ALo(2,"async"),e.ALo(3,"async"),e.ALo(4,"async"),e.qZA()}if(2&n){const t=e.oxw();e.Q6J("elements",e.lcZ(1,14,t.members$))("dictOptionDtos",e.lcZ(2,16,t.memberOptionsService.dictOptionDtos$))("totalRecord",e.lcZ(3,18,t.totalCount$))("columnToDisplays",t.displayedColumns)("pageSize",t.pageSize)("configuration",t.tableConfiguration)("showColSearch",t.showColSearch)("globalSearchValue",t.globalSearchValue)("canEdit",t.canEdit)("canAdd",t.canAdd)("canSelectElement",t.canDelete)("loading",e.lcZ(4,20,t.loading$))("viewPreference",t.viewPreference)("tableStateKey",t.tableStateKey)}}let yt=(()=>{class n extends ft{constructor(t,o,i){super(t),this.siteService=o,this.authService=i}ngOnInit(){var t;this.teamTypeId=N.k0.Site,super.ngOnInit(),this.parentIds=[null===(t=this.siteService.currentSiteId)||void 0===t?void 0:t.toString()]}setPermissions(){this.canEdit=this.authService.hasPermission(M.y.Site_Member_Update),this.canDelete=this.authService.hasPermission(M.y.Site_Member_Delete),this.canAdd=this.authService.hasPermission(M.y.Site_Member_Create)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(D.P),e.Y36(F.e))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-site-members-index"]],features:[e.qOj],decls:8,vars:16,consts:[["fxLayout","","fxLayout.xs","column","fxLayoutWrap","wrap"],["fxFlex","100"],[3,"headerTitle","canAdd","canDelete","canExportCSV","selectedElements","create","exportCSV","delete"],[3,"defaultPageSize","length","columns","columnToDisplays","tableStateKey","displayedColumnsChange","filter","pageSizeChange","toggleSearch","viewChange"],[3,"elements","totalRecord","columnToDisplays","pageSize","configuration","showColSearch","globalSearchValue","canClickRow","canSelectElement","loading","viewPreference","tableStateKey","clickRow","loadLazy","selectedElementsChanged",4,"ngIf"],[3,"elements","dictOptionDtos","totalRecord","columnToDisplays","pageSize","configuration","showColSearch","globalSearchValue","canEdit","canAdd","canSelectElement","loading","viewPreference","tableStateKey","loadLazy","selectedElementsChanged","save",4,"ngIf"],[3,"elements","totalRecord","columnToDisplays","pageSize","configuration","showColSearch","globalSearchValue","canClickRow","canSelectElement","loading","viewPreference","tableStateKey","clickRow","loadLazy","selectedElementsChanged"],[3,"elements","dictOptionDtos","totalRecord","columnToDisplays","pageSize","configuration","showColSearch","globalSearchValue","canEdit","canAdd","canSelectElement","loading","viewPreference","tableStateKey","loadLazy","selectedElementsChanged","save"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"bia-table-header",2),e.NdJ("create",function(){return o.onCreate()})("exportCSV",function(){return o.onExportCSV()})("delete",function(){return o.onDelete()}),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"bia-table-controller",3),e.NdJ("displayedColumnsChange",function(s){return o.displayedColumnsChanged(s)})("filter",function(s){return o.searchGlobalChanged(s)})("pageSizeChange",function(s){return o.onPageSizeChange(s)})("toggleSearch",function(){return o.onToggleSearch()})("viewChange",function(s){return o.onViewChange(s)}),e.ALo(5,"async"),e.qZA(),e.YNc(6,Ct,4,18,"bia-table",4),e.YNc(7,vt,5,22,"bia-member-table",5),e.qZA()()),2&t&&(e.xp6(2),e.Q6J("headerTitle",e.lcZ(3,12,"member.listOfSiteMembers"))("canAdd",o.canAdd&&!o.useCalcMode)("canDelete",o.canDelete)("canExportCSV",!0)("selectedElements",o.selectedMembers),e.xp6(2),e.Q6J("defaultPageSize",o.defaultPageSize)("length",e.lcZ(5,14,o.totalCount$))("columns",o.columns)("columnToDisplays",o.displayedColumns)("tableStateKey",o.tableStateKey),e.xp6(2),e.Q6J("ngIf",!o.useCalcMode),e.xp6(1),e.Q6J("ngIf",o.useCalcMode))},directives:[g.xw,g.yH,q.l,ee.B,p.O5,Y.$,ne],pipes:[C.X$,p.Ov],styles:["[_nghost-%COMP%]{flex-direction:column}bia-table-controller[_ngcontent-%COMP%]{margin-left:-35px;margin-right:-35px}"]}),n})();var oe=r(9417);class H{}var St=r(6526),ae=r(845),ie=r(5055),re=r(5224);function Mt(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",12)(1,"button",13),e.NdJ("click",function(){return e.CHM(t),e.oxw().addUserFromDirectory()}),e.qZA()()}}const se=function(){return{width:"100%"}};let le=(()=>{class n{constructor(t,o){this.formBuilder=t,this.translateService=o,this.members={},this.canAddFromDirectory=!1,this.save=new e.vpe,this.cancel=new e.vpe,this.displayUserAddFromDirectoryDialog=!1,this.initForm()}ngOnChanges(t){if(this.members){let o=this.form.value.users;o&&(this.members.users=this.members.users.concat(o)),this.form.reset(),this.form.patchValue(Object.assign({},this.members))}}initForm(){this.form=this.formBuilder.group({users:[this.members.users,d.kI.required],roles:[]})}onCancel(){this.form.reset(),this.cancel.next()}addUserFromDirectory(){this.displayUserAddFromDirectoryDialog=!0}onSubmit(){var t;if(this.form.valid){const o=this.form.value;o.roles=R.P.Differential(o.roles,null===(t=this.members)||void 0===t?void 0:t.roles),o.users=R.P.Differential(o.users,[]),o.teamId=this.teamId,this.save.emit(o),this.form.reset()}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(d.qu),e.Y36(C.sK))},n.\u0275cmp=e.Xpm({type:n,selectors:[["bia-member-form-new"]],inputs:{members:"members",roleOptions:"roleOptions",userOptions:"userOptions",teamId:"teamId",canAddFromDirectory:"canAddFromDirectory"},outputs:{save:"save",cancel:"cancel"},features:[e.TTD],decls:25,vars:26,consts:[["fxLayout","column",3,"formGroup","submit"],["fxLayout","row","fxLayoutAlign","center"],["fxFlex","90",1,"app-field-container"],[1,"p-float-label"],["defaultLabel","\xa0","formControlName","users","optionLabel","display","datakey","id","appendTo","body",3,"options","virtualScroll"],[1,"bia-star-mandatory"],["class","app-field-container","fxFlex","10",4,"ngIf"],["formControlName","roles","multiple","multiple","checkbox","checkbox","optionLabel","display",3,"options","showToggleAll"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","end end"],["pButton","","type","submit",3,"label","disabled"],["pButton","","type","button",1,"p-button-secondary",3,"label","click"],[3,"display","displayChange"],["fxFlex","10",1,"app-field-container"],["pButton","","pRipple","","type","button","icon","pi pi-plus",1,"p-button-sm","p-button-rounded","p-button-text","align-right",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"form",0),e.NdJ("submit",function(){return o.onSubmit()}),e.TgZ(1,"div",1)(2,"div",2)(3,"div",1)(4,"div",2)(5,"span",3),e._UZ(6,"p-multiSelect",4),e.TgZ(7,"label")(8,"span",5),e._uU(9,"*"),e.qZA(),e._uU(10),e.ALo(11,"translate"),e.qZA()()(),e.YNc(12,Mt,2,0,"div",6),e.qZA()()(),e.TgZ(13,"div",1)(14,"div",2)(15,"label"),e._uU(16),e.ALo(17,"translate"),e.qZA(),e._UZ(18,"p-listbox",7),e.qZA()(),e.TgZ(19,"div",8),e._UZ(20,"button",9),e.ALo(21,"translate"),e.TgZ(22,"button",10),e.NdJ("click",function(){return o.onCancel()}),e.ALo(23,"translate"),e.qZA()()(),e.TgZ(24,"bia-user-add-from-directory-dialog",11),e.NdJ("displayChange",function(s){return o.displayUserAddFromDirectoryDialog=s}),e.qZA()),2&t&&(e.Q6J("formGroup",o.form),e.xp6(6),e.Akn(e.DdM(24,se)),e.Q6J("options",o.userOptions)("virtualScroll",!0),e.xp6(4),e.Oqu(e.lcZ(11,16,"member.user")),e.xp6(2),e.Q6J("ngIf",o.canAddFromDirectory),e.xp6(4),e.hij("",e.lcZ(17,18,"member.roles"),":"),e.xp6(2),e.Akn(e.DdM(25,se)),e.Q6J("options",o.roleOptions)("showToggleAll",!1),e.xp6(2),e.s9C("label",e.lcZ(21,20,"bia.save")),e.Q6J("disabled",!o.form.valid),e.xp6(2),e.s9C("label",e.lcZ(23,22,"bia.cancel")),e.xp6(2),e.Q6J("display",o.displayUserAddFromDirectoryDialog))},directives:[d._Y,d.JL,g.xw,d.sg,g.Wh,g.yH,St.NU,d.JJ,d.u,p.O5,ae.Hq,ie.Ri,g.SQ,re.C],pipes:[C.X$],styles:[".app-field-container[_ngcontent-%COMP%]{margin-bottom:20px}.align-right[_ngcontent-%COMP%]{margin-left:auto;display:block;padding-right:0}"]}),n})(),xt=(()=>{class n{constructor(t){this.sub=new f.w,this.canAddFromDirectory=!1,this.store=t.get(l.yh),this.router=t.get(h.F0),this.activatedRoute=t.get(h.gz),this.memberOptionsService=t.get(K),this.authService=t.get(F.e)}ngOnInit(){this.sub=new f.w,this.canAddFromDirectory=this.authService.hasPermission(M.y.User_Add),this.members=new H,this.memberOptionsService.loadAllOptions(this.teamTypeId),this.sub.add(this.store.select(J.nC).pipe((0,G.T)(1)).subscribe(t=>{this.memberOptionsService.refreshUsersOptions(),this.members.users=t}))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}onSubmitted(t){this.store.dispatch(c.createMulti({members:t})),this.members=new H,this.router.navigate(["../"],{relativeTo:this.activatedRoute})}onCancelled(){this.members=new H,this.router.navigate(["../"],{relativeTo:this.activatedRoute})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["bia-member-new"]],decls:3,vars:9,consts:[[3,"members","roleOptions","userOptions","teamId","canAddFromDirectory","cancel","save"]],template:function(t,o){1&t&&(e.TgZ(0,"bia-member-form-new",0),e.NdJ("cancel",function(){return o.onCancelled()})("save",function(s){return o.onSubmitted(s)}),e.ALo(1,"async"),e.ALo(2,"async"),e.qZA()),2&t&&e.Q6J("members",o.members)("roleOptions",e.lcZ(1,5,o.memberOptionsService.roleOptions$))("userOptions",e.lcZ(2,7,o.memberOptionsService.userOptions$))("teamId",o.teamId)("canAddFromDirectory",o.canAddFromDirectory)},directives:[le],pipes:[p.Ov],styles:[""]}),n})(),Tt=(()=>{class n extends xt{constructor(t,o){super(t),this.siteService=o}ngOnInit(){this.teamId=this.siteService.currentSiteId,this.teamTypeId=N.k0.Site,super.ngOnInit()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(D.P))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-site-member-new"]],features:[e.qOj],decls:3,vars:9,consts:[[3,"members","roleOptions","userOptions","teamId","canAddFromDirectory","cancel","save"]],template:function(t,o){1&t&&(e.TgZ(0,"bia-member-form-new",0),e.NdJ("cancel",function(){return o.onCancelled()})("save",function(s){return o.onSubmitted(s)}),e.ALo(1,"async"),e.ALo(2,"async"),e.qZA()),2&t&&e.Q6J("members",o.members)("roleOptions",e.lcZ(1,5,o.memberOptionsService.roleOptions$))("userOptions",e.lcZ(2,7,o.memberOptionsService.userOptions$))("teamId",o.teamId)("canAddFromDirectory",o.canAddFromDirectory)},directives:[le],pipes:[p.Ov],styles:[""]}),n})(),ce=(()=>{class n{constructor(t){this.store=t,this.sub=new f.w,this.InitSub(),this.loading$=this.store.select(Ce),this.member$=this.store.select(Q)}get currentMember(){var t;return(null===(t=this._currentMember)||void 0===t?void 0:t.id)===this._currentMemberId?this._currentMember:null}get currentMemberId(){return this._currentMemberId}set currentMemberId(t){this._currentMemberId=Number(t),this.store.dispatch(c.load({id:t}))}InitSub(){this.sub=new f.w,this.sub.add(this.store.select(Q).subscribe(t=>{t&&(this._currentMember=t)}))}}return n.\u0275fac=function(t){return new(t||n)(e.LFG(l.yh))},n.\u0275prov=e.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var wt=r(4036);function At(n,a){if(1&n){const t=e.EpF();e.TgZ(0,"div",12)(1,"button",13),e.NdJ("click",function(){return e.CHM(t),e.oxw().addUserFromDirectory()}),e.qZA()()}}const me=function(){return{width:"100%"}};let pe=(()=>{class n{constructor(t,o){this.formBuilder=t,this.translateService=o,this.member={},this.canAddFromDirectory=!1,this.save=new e.vpe,this.cancel=new e.vpe,this.displayUserAddFromDirectoryDialog=!1,this.initForm()}ngOnChanges(t){this.member&&(this.form.reset(),this.member&&this.form.patchValue(Object.assign({},this.member)))}initForm(){this.form=this.formBuilder.group({id:[this.member.id],user:[this.member.user,d.kI.required],roles:[this.member.roles]})}onCancel(){this.form.reset(),this.cancel.next()}addUserFromDirectory(){this.displayUserAddFromDirectoryDialog=!0}onSubmit(){var t;if(this.form.valid){const o=this.form.value;o.id=o.id>0?o.id:0,o.roles=R.P.Differential(o.roles,null===(t=this.member)||void 0===t?void 0:t.roles),o.user=Object.assign({},o.user),o.teamId=this.teamId,this.save.emit(o),this.form.reset()}}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(d.qu),e.Y36(C.sK))},n.\u0275cmp=e.Xpm({type:n,selectors:[["bia-member-form-edit"]],inputs:{member:"member",roleOptions:"roleOptions",userOptions:"userOptions",teamId:"teamId",canAddFromDirectory:"canAddFromDirectory"},outputs:{save:"save",cancel:"cancel"},features:[e.TTD],decls:25,vars:27,consts:[["fxLayout","column",3,"formGroup","submit"],["fxLayout","row","fxLayoutAlign","center"],["fxFlex","90",1,"app-field-container"],[1,"p-float-label"],["placeholder","\xa0","formControlName","user","optionLabel","display","datakey","id",3,"options","filter","showClear"],[1,"bia-star-mandatory"],["class","app-field-container","fxFlex","10",4,"ngIf"],["formControlName","roles","multiple","multiple","checkbox","checkbox","optionLabel","display",3,"options","showToggleAll"],["fxLayout","row","fxLayoutGap","5px","fxLayoutAlign","end end"],["pButton","","type","submit",3,"label","disabled"],["pButton","","type","button",1,"p-button-secondary",3,"label","click"],[3,"display","displayChange"],["fxFlex","10",1,"app-field-container"],["pButton","","pRipple","","type","button","icon","pi pi-plus",1,"p-button-sm","p-button-rounded","p-button-text","align-right",3,"click"]],template:function(t,o){1&t&&(e.TgZ(0,"form",0),e.NdJ("submit",function(){return o.onSubmit()}),e.TgZ(1,"div",1)(2,"div",2)(3,"div",1)(4,"div",2)(5,"span",3),e._UZ(6,"p-dropdown",4),e.TgZ(7,"label")(8,"span",5),e._uU(9,"*"),e.qZA(),e._uU(10),e.ALo(11,"translate"),e.qZA()()(),e.YNc(12,At,2,0,"div",6),e.qZA()()(),e.TgZ(13,"div",1)(14,"div",2)(15,"label"),e._uU(16),e.ALo(17,"translate"),e.qZA(),e._UZ(18,"p-listbox",7),e.qZA()(),e.TgZ(19,"div",8),e._UZ(20,"button",9),e.ALo(21,"translate"),e.TgZ(22,"button",10),e.NdJ("click",function(){return o.onCancel()}),e.ALo(23,"translate"),e.qZA()()(),e.TgZ(24,"bia-user-add-from-directory-dialog",11),e.NdJ("displayChange",function(s){return o.displayUserAddFromDirectoryDialog=s}),e.qZA()),2&t&&(e.Q6J("formGroup",o.form),e.xp6(6),e.Akn(e.DdM(25,me)),e.Q6J("options",o.userOptions)("filter",!0)("showClear",!0),e.xp6(4),e.Oqu(e.lcZ(11,17,"member.user")),e.xp6(2),e.Q6J("ngIf",o.canAddFromDirectory),e.xp6(4),e.hij("",e.lcZ(17,19,"member.roles"),":"),e.xp6(2),e.Akn(e.DdM(26,me)),e.Q6J("options",o.roleOptions)("showToggleAll",!1),e.xp6(2),e.s9C("label",e.lcZ(21,21,"bia.save")),e.Q6J("disabled",!o.form.valid),e.xp6(2),e.s9C("label",e.lcZ(23,23,"bia.cancel")),e.xp6(2),e.Q6J("display",o.displayUserAddFromDirectoryDialog))},directives:[d._Y,d.JL,g.xw,d.sg,g.Wh,g.yH,wt.Lt,d.JJ,d.u,p.O5,ae.Hq,ie.Ri,g.SQ,re.C],pipes:[C.X$],styles:[".app-field-container[_ngcontent-%COMP%]{margin-bottom:20px}.align-right[_ngcontent-%COMP%]{margin-left:auto;display:block;padding-right:0}"]}),n})();var z=r(9373);function It(n,a){1&n&&e._UZ(0,"bia-spinner",2),2&n&&e.Q6J("overlay",!0)}let Ot=(()=>{class n{constructor(t){this.displayChange=new e.vpe,this.sub=new f.w,this.canAddFromDirectory=!1,this.memberService=t.get(ce),this.store=t.get(l.yh),this.router=t.get(h.F0),this.activatedRoute=t.get(h.gz),this.memberOptionsService=t.get(K),this.authService=t.get(F.e)}ngOnInit(){this.sub=new f.w,this.canAddFromDirectory=this.authService.hasPermission(M.y.User_Add),this.memberOptionsService.loadAllOptions(this.teamTypeId),this.sub.add(this.store.select(J.nC).pipe((0,G.T)(1)).subscribe(t=>{this.memberOptionsService.refreshUsersOptions()}))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}onSubmitted(t){this.store.dispatch(c.update({member:t})),this.router.navigate(["../../"],{relativeTo:this.activatedRoute})}onCancelled(){this.router.navigate(["../../"],{relativeTo:this.activatedRoute})}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["bia-member-edit"]],outputs:{displayChange:"displayChange"},decls:6,vars:14,consts:[[3,"member","roleOptions","userOptions","teamId","canAddFromDirectory","cancel","save"],[3,"overlay",4,"ngIf"],[3,"overlay"]],template:function(t,o){1&t&&(e.TgZ(0,"bia-member-form-edit",0),e.NdJ("cancel",function(){return o.onCancelled()})("save",function(s){return o.onSubmitted(s)}),e.ALo(1,"async"),e.ALo(2,"async"),e.ALo(3,"async"),e.qZA(),e.YNc(4,It,1,1,"bia-spinner",1),e.ALo(5,"async")),2&t&&(e.Q6J("member",e.lcZ(1,6,o.memberService.member$))("roleOptions",e.lcZ(2,8,o.memberOptionsService.roleOptions$))("userOptions",e.lcZ(3,10,o.memberOptionsService.userOptions$))("teamId",o.teamId)("canAddFromDirectory",o.canAddFromDirectory),e.xp6(4),e.Q6J("ngIf",e.lcZ(5,12,o.memberService.loading$)))},directives:[pe,p.O5,z.O],pipes:[p.Ov],styles:[""]}),n})();function Lt(n,a){1&n&&e._UZ(0,"bia-spinner",2),2&n&&e.Q6J("overlay",!0)}let Zt=(()=>{class n extends Ot{constructor(t,o){super(t),this.siteService=o}ngOnInit(){this.teamId=this.siteService.currentSiteId,this.teamTypeId=N.k0.Site,super.ngOnInit()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3),e.Y36(D.P))},n.\u0275cmp=e.Xpm({type:n,selectors:[["app-site-member-edit"]],features:[e.qOj],decls:6,vars:14,consts:[[3,"member","roleOptions","userOptions","teamId","canAddFromDirectory","cancel","save"],[3,"overlay",4,"ngIf"],[3,"overlay"]],template:function(t,o){1&t&&(e.TgZ(0,"bia-member-form-edit",0),e.NdJ("cancel",function(){return o.onCancelled()})("save",function(s){return o.onSubmitted(s)}),e.ALo(1,"async"),e.ALo(2,"async"),e.ALo(3,"async"),e.qZA(),e.YNc(4,Lt,1,1,"bia-spinner",1),e.ALo(5,"async")),2&t&&(e.Q6J("member",e.lcZ(1,6,o.memberService.member$))("roleOptions",e.lcZ(2,8,o.memberOptionsService.roleOptions$))("userOptions",e.lcZ(3,10,o.memberOptionsService.userOptions$))("teamId",o.teamId)("canAddFromDirectory",o.canAddFromDirectory),e.xp6(4),e.Q6J("ngIf",e.lcZ(5,12,o.memberService.loading$)))},directives:[pe,p.O5,z.O],pipes:[p.Ov],styles:[""]}),n})();var P=r(6249),Ft=r(466);function Dt(n,a){1&n&&e._UZ(0,"bia-spinner",1),2&n&&e.Q6J("overlay",!0)}let Et=(()=>{class n{constructor(t){this.sub=new f.w,this.store=t.get(l.yh),this.activatedRoute=t.get(h.gz),this.memberService=t.get(ce),this.layoutService=t.get(Ft.N)}ngOnInit(){this.memberService.currentMemberId=this.activatedRoute.snapshot.params.memberId,this.sub.add(this.store.select(Q).subscribe(t=>{(null==t?void 0:t.user)&&(this.activatedRoute.data.pipe((0,j.P)()).subscribe(o=>{o.breadcrumb=t.user.display}),this.layoutService.refreshBreadcrumb())}))}ngOnDestroy(){this.sub&&this.sub.unsubscribe()}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],decls:3,vars:3,consts:[[3,"overlay",4,"ngIf"],[3,"overlay"]],template:function(t,o){1&t&&(e._UZ(0,"router-outlet"),e.YNc(1,Dt,1,1,"bia-spinner",0),e.ALo(2,"async")),2&t&&(e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,o.memberService.loading$)))},directives:[h.lC,p.O5,z.O],pipes:[p.Ov],styles:[""]}),n})();function Nt(n,a){1&n&&e._UZ(0,"bia-spinner",1),2&n&&e.Q6J("overlay",!0)}let Jt=(()=>{class n extends Et{constructor(t){super(t)}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(e.zs3))},n.\u0275cmp=e.Xpm({type:n,selectors:[["ng-component"]],features:[e.qOj],decls:3,vars:3,consts:[[3,"overlay",4,"ngIf"],[3,"overlay"]],template:function(t,o){1&t&&(e._UZ(0,"router-outlet"),e.YNc(1,Nt,1,1,"bia-spinner",0),e.ALo(2,"async")),2&t&&(e.xp6(1),e.Q6J("ngIf",e.lcZ(2,1,o.memberService.loading$)))},directives:[h.lC,p.O5,z.O],pipes:[p.Ov],styles:[""]}),n})();var de=r(8832),Rt=r(3460),zt=r(2566),Pt=r(3931),$t=r(3822);let Qt=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[oe.m,l.Aw.forFeature("members",ge),_.sQ.forFeature([U]),Pt.U,zt.p,$t.q]]}),n})();const Yt=[{path:"",data:{breadcrumb:null,permission:M.y.Site_Member_List_Access,InjectComponent:yt},component:Rt.e,canActivate:[P.n],children:[{path:"create",data:{breadcrumb:"bia.add",canNavigate:!1,permission:M.y.Site_Member_Create,title:"member.add",InjectComponent:Tt},component:de._,canActivate:[P.n]},{path:":memberId",data:{breadcrumb:"",canNavigate:!0},component:Jt,canActivate:[P.n],children:[{path:"edit",data:{breadcrumb:"member.manage",canNavigate:!0,permission:M.y.Site_Member_Update,title:"member.manage",InjectComponent:Zt},component:de._,canActivate:[P.n]},{path:"",redirectTo:"edit"}]}]},{path:"**",redirectTo:""}];let Ut=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[oe.m,h.Bz.forChild(Yt),Qt]]}),n})()}}]);